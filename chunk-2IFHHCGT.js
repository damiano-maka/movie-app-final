import{H as Nc,L as Oc,M as cr,N as ur,O as lr,R as hr,Sa as Vc,Ta as Lc,Z as Ue,a as Pc,aa as dr,b as Cc,ba as xc,c as d,d as ji,h as Dc,i as kc,j as Wi,k as Ki,l as Hi,na as vt}from"./chunk-UZ4CZCYJ.js";var Fc=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Pd=function(t){let e=[],n=0,r=0;for(;n<t.length;){let i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[n++],o=t[n++],a=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Uc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){let s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,l=s>>2,h=(s&3)<<4|a>>4,f=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[l],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Fc(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Pd(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){let s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;let u=i<t.length?n[t.charAt(i)]:64;++i;let h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||h==null)throw new Yi;let f=s<<2|a>>4;if(r.push(f),u!==64){let m=a<<4&240|u>>2;if(r.push(m),h!==64){let S=u<<6&192|h;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Yi=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Cd=function(t){let e=Fc(t);return Uc.encodeByteArray(e,!0)},rn=function(t){return Cd(t).replace(/\./g,"")},Xi=function(t){try{return Uc.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Dd(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var kd=()=>Dd().__FIREBASE_DEFAULTS__,Nd=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Od=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&Xi(t[1]);return e&&JSON.parse(e)},Zi=()=>{try{return kd()||Nd()||Od()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Bc=t=>{var e,n;return(n=(e=Zi())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},qc=t=>{let e=Bc(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},es=()=>{var t;return(t=Zi())===null||t===void 0?void 0:t.config},$c=t=>{var e;return(e=Zi())===null||e===void 0?void 0:e[`_${t}`]};var fr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function zc(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[rn(JSON.stringify(n)),rn(JSON.stringify(o)),a].join(".")}function he(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gc(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(he())}function jc(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Wc(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ts(){try{return typeof indexedDB=="object"}catch{return!1}}function Kc(){return new Promise((t,e)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var xd="FirebaseError",le=class t extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=xd,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oe.prototype.create)}},Oe=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){let r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?Vd(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new le(i,a,r)}};function Vd(t,e){return t.replace(Ld,(n,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Ld=/\{\$([^}]+)}/g;function Et(t,e){if(t===e)return!0;let n=Object.keys(t),r=Object.keys(e);for(let i of n){if(!r.includes(i))return!1;let s=t[i],o=e[i];if(Mc(s)&&Mc(o)){if(!Et(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!n.includes(i))return!1;return!0}function Mc(t){return t!==null&&typeof t=="object"}function ns(t){let e=[];for(let[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Hc(t,e){let n=new Ji(t,e);return n.subscribe.bind(n)}var Ji=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Md(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Qi),i.error===void 0&&(i.error=Qi),i.complete===void 0&&(i.complete=Qi);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Md(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Qi(){}var Ty=4*60*60*1e3;function de(t){return t&&t._delegate?t._delegate:t}var fe=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Xe="[DEFAULT]";var rs=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let r=new fr;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ud(e))try{this.getOrInitializeService({instanceIdentifier:Xe})}catch{}for(let[n,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Xe){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return d(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Xe){return this.instances.has(e)}getOptions(e=Xe){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;let i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let r=this.onInitCallbacks.get(n);if(r)for(let i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Fd(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xe){return this.component?this.component.multipleInstances?e:Xe:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Fd(t){return t===Xe?void 0:t}function Ud(t){return t.instantiationMode==="EAGER"}var pr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new rs(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var Bd=[],P=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(P||{}),qd={debug:P.DEBUG,verbose:P.VERBOSE,info:P.INFO,warn:P.WARN,error:P.ERROR,silent:P.SILENT},$d=P.INFO,zd={[P.DEBUG]:"log",[P.VERBOSE]:"log",[P.INFO]:"info",[P.WARN]:"warn",[P.ERROR]:"error"},Gd=(t,e,...n)=>{if(e<t.logLevel)return;let r=new Date().toISOString(),i=zd[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Be=class{constructor(e){this.name=e,this._logLevel=$d,this._logHandler=Gd,this._userLogHandler=null,Bd.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in P))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qd[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,P.DEBUG,...e),this._logHandler(this,P.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,P.VERBOSE,...e),this._logHandler(this,P.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,P.INFO,...e),this._logHandler(this,P.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,P.WARN,...e),this._logHandler(this,P.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,P.ERROR,...e),this._logHandler(this,P.ERROR,...e)}};var jd=(t,e)=>e.some(n=>t instanceof n),Qc,Yc;function Wd(){return Qc||(Qc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Kd(){return Yc||(Yc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Jc=new WeakMap,ss=new WeakMap,Xc=new WeakMap,is=new WeakMap,as=new WeakMap;function Hd(t){let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ee(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Jc.set(n,t)}).catch(()=>{}),as.set(e,t),e}function Qd(t){if(ss.has(t))return;let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});ss.set(t,e)}var os={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ss.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Xc.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ee(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Zc(t){os=t(os)}function Yd(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let r=t.call(mr(this),e,...n);return Xc.set(r,e.sort?e.sort():[e]),Ee(r)}:Kd().includes(t)?function(...e){return t.apply(mr(this),e),Ee(Jc.get(this))}:function(...e){return Ee(t.apply(mr(this),e))}}function Jd(t){return typeof t=="function"?Yd(t):(t instanceof IDBTransaction&&Qd(t),jd(t,Wd())?new Proxy(t,os):t)}function Ee(t){if(t instanceof IDBRequest)return Hd(t);if(is.has(t))return is.get(t);let e=Jd(t);return e!==t&&(is.set(t,e),as.set(e,t)),e}var mr=t=>as.get(t);function tu(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(t,e),a=Ee(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Ee(o.result),c.oldVersion,c.newVersion,Ee(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var Xd=["get","getKey","getAll","getAllKeys","count"],Zd=["put","add","delete","clear"],cs=new Map;function eu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cs.get(e))return cs.get(e);let n=e.replace(/FromIndex$/,""),r=e!==n,i=Zd.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Xd.includes(n)))return;let s=function(o,...a){return d(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(yield Promise.all([u[n](...a),i&&c.done]))[0]})};return cs.set(e,s),s}Zc(t=>Cc(Pc({},t),{get:(e,n,r)=>eu(e,n)||t.get(e,n,r),has:(e,n)=>!!eu(e,n)||t.has(e,n)}));var ls=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(ef(n)){let r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function ef(t){let e=t.getComponent();return e?.type==="VERSION"}var hs="@firebase/app",nu="0.9.25";var Ze=new Be("@firebase/app"),tf="@firebase/app-compat",nf="@firebase/analytics-compat",rf="@firebase/analytics",sf="@firebase/app-check-compat",of="@firebase/app-check",af="@firebase/auth",cf="@firebase/auth-compat",uf="@firebase/database",lf="@firebase/database-compat",hf="@firebase/functions",df="@firebase/functions-compat",ff="@firebase/installations",pf="@firebase/installations-compat",mf="@firebase/messaging",gf="@firebase/messaging-compat",_f="@firebase/performance",yf="@firebase/performance-compat",If="@firebase/remote-config",vf="@firebase/remote-config-compat",Ef="@firebase/storage",wf="@firebase/storage-compat",Tf="@firebase/firestore",Af="@firebase/firestore-compat",Sf="firebase",Rf="10.7.1";var ds="[DEFAULT]",bf={[hs]:"fire-core",[tf]:"fire-core-compat",[rf]:"fire-analytics",[nf]:"fire-analytics-compat",[of]:"fire-app-check",[sf]:"fire-app-check-compat",[af]:"fire-auth",[cf]:"fire-auth-compat",[uf]:"fire-rtdb",[lf]:"fire-rtdb-compat",[hf]:"fire-fn",[df]:"fire-fn-compat",[ff]:"fire-iid",[pf]:"fire-iid-compat",[mf]:"fire-fcm",[gf]:"fire-fcm-compat",[_f]:"fire-perf",[yf]:"fire-perf-compat",[If]:"fire-rc",[vf]:"fire-rc-compat",[Ef]:"fire-gcs",[wf]:"fire-gcs-compat",[Tf]:"fire-fst",[Af]:"fire-fst-compat","fire-js":"fire-js",[Sf]:"fire-js-all"};var sn=new Map,fs=new Map;function Pf(t,e){try{t.container.addComponent(e)}catch(n){Ze.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $e(t){let e=t.name;if(fs.has(e))return Ze.debug(`There were multiple attempts to register component ${e}.`),!1;fs.set(e,t);for(let n of sn.values())Pf(n,t);return!0}function _s(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}var Cf={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},qe=new Oe("app","Firebase",Cf);var ps=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new fe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qe.create("app-deleted",{appName:this._name})}};var wt=Rf;function ys(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ds,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw qe.create("bad-app-name",{appName:String(i)});if(n||(n=es()),!n)throw qe.create("no-options");let s=sn.get(i);if(s){if(Et(n,s.options)&&Et(r,s.config))return s;throw qe.create("duplicate-app",{appName:i})}let o=new pr(i);for(let c of fs.values())o.addComponent(c);let a=new ps(n,r,o);return sn.set(i,a),a}function an(t=ds){let e=sn.get(t);if(!e&&t===ds&&es())return ys();if(!e)throw qe.create("no-app",{appName:t});return e}function gr(){return Array.from(sn.values())}function K(t,e,n){var r;let i=(r=bf[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ze.warn(a.join(" "));return}$e(new fe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Df="firebase-heartbeat-database",kf=1,on="firebase-heartbeat-store",us=null;function ou(){return us||(us=tu(Df,kf,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(on)}}}).catch(t=>{throw qe.create("idb-open",{originalErrorMessage:t.message})})),us}function Nf(t){return d(this,null,function*(){try{return yield(yield ou()).transaction(on).objectStore(on).get(au(t))}catch(e){if(e instanceof le)Ze.warn(e.message);else{let n=qe.create("idb-get",{originalErrorMessage:e?.message});Ze.warn(n.message)}}})}function ru(t,e){return d(this,null,function*(){try{let r=(yield ou()).transaction(on,"readwrite");yield r.objectStore(on).put(e,au(t)),yield r.done}catch(n){if(n instanceof le)Ze.warn(n.message);else{let r=qe.create("idb-set",{originalErrorMessage:n?.message});Ze.warn(r.message)}}})}function au(t){return`${t.name}!${t.options.appId}`}var Of=1024,xf=30*24*60*60*1e3,ms=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new gs(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return d(this,null,function*(){var e,n;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=iu();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=xf}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return d(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=iu(),{heartbeatsToSend:r,unsentEntries:i}=Vf(this._heartbeatsCache.heartbeats),s=rn(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function iu(){return new Date().toISOString().substring(0,10)}function Vf(t,e=Of){let n=[],r=t.slice();for(let i of t){let s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),su(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),su(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var gs=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return d(this,null,function*(){return ts()?Kc().then(()=>!0).catch(()=>!1):!1})}read(){return d(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield Nf(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return d(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return ru(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return d(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return ru(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function su(t){return rn(JSON.stringify({version:2,heartbeats:t})).length}function Lf(t){$e(new fe("platform-logger",e=>new ls(e),"PRIVATE")),$e(new fe("heartbeat",e=>new ms(e),"PRIVATE")),K(hs,nu,t),K(hs,nu,"esm2017"),K("fire-js","")}Lf("");var Mf="firebase",Ff="10.7.1";K(Mf,Ff,"app");var At=new Vc("ANGULARFIRE2_VERSION");function vs(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var un=(t,e)=>{let n=e?[e]:gr(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},cn=class{constructor(){return un(Uf)}},Uf="app-check";function Tt(){}var _r=class{zone;delegate;constructor(e,n=kc){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Is=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Tt,{},Tt,Tt)),n.pipe(Nc({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ln=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new _r(Zone.current)),this.insideAngular=n.run(()=>new _r(Zone.current,Dc)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(lr(vt))};static \u0275prov=Oc({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function yr(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Bf(t){return yr().ngZone.runOutsideAngular(()=>t())}function et(t){return yr().ngZone.run(()=>t())}function qf(t){return $f(yr())(t)}function $f(t){return function(n){return n=n.lift(new Is(t.ngZone)),n.pipe(Hi(t.outsideAngular),Ki(t.insideAngular))}}var zf=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),et(()=>t.apply(void 0,r))},hn=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=et(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Tt,{},Tt,Tt))),r[s]=zf(r[s],n));let i=Bf(()=>t.apply(this,r));if(!e)if(i instanceof ji){let s=yr();return i.pipe(Hi(s.outsideAngular),Ki(s.insideAngular))}else return et(()=>i);return i instanceof ji?i.pipe(qf):i instanceof Promise?et(()=>new Promise((s,o)=>i.then(a=>et(()=>s(a)),a=>et(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:et(()=>i)};var tt=class{constructor(e){return e}},dn=class{constructor(){return gr()}};function Gf(t){return t&&t.length===1?t[0]:new tt(an())}var Es=new ur("angularfire2._apps"),jf={provide:tt,useFactory:Gf,deps:[[new Ue,Es]]},Wf={provide:dn,deps:[[new Ue,Es]]};function Kf(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new tt(r)}}var Hf=(()=>{class t{constructor(n){K("angularfire",At.full,"core"),K("angularfire",At.full,"app"),K("angular",Lc.full,n.toString())}static \u0275fac=function(r){return new(r||t)(lr(xc))};static \u0275mod=hr({type:t});static \u0275inj=cr({providers:[jf,Wf]})}return t})();function oI(t,...e){return{ngModule:Hf,providers:[{provide:Es,useFactory:Kf(t),multi:!0,deps:[vt,dr,ln,...e]}]}}var aI=hn(ys,!0);var Qf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ge={},_,zs=zs||{},T=Qf||self;function Nr(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Rn(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Yf(t){return Object.prototype.hasOwnProperty.call(t,ws)&&t[ws]||(t[ws]=++Jf)}var ws="closure_uid_"+(1e9*Math.random()>>>0),Jf=0;function Xf(t,e,n){return t.call.apply(t.bind,arguments)}function Zf(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function te(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?te=Xf:te=Zf,te.apply(null,arguments)}function Ir(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Q(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function ze(){this.s=this.s,this.o=this.o}var ep=0;ze.prototype.s=!1;ze.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),ep!=0)&&Yf(this)};ze.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Eu=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Gs(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function uu(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Nr(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function ne(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var tp=function(){if(!T.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};T.addEventListener("test",n,e),T.removeEventListener("test",n,e)}catch{}return t}();function yn(t){return/^[\s\xa0]*$/.test(t)}function Or(){var t=T.navigator;return t&&(t=t.userAgent)?t:""}function we(t){return Or().indexOf(t)!=-1}function js(t){return js[" "](t),t}js[" "]=function(){};function np(t,e){var n=Gp;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var rp=we("Opera"),Pt=we("Trident")||we("MSIE"),wu=we("Edge"),bs=wu||Pt,Tu=we("Gecko")&&!(Or().toLowerCase().indexOf("webkit")!=-1&&!we("Edge"))&&!(we("Trident")||we("MSIE"))&&!we("Edge"),ip=Or().toLowerCase().indexOf("webkit")!=-1&&!we("Edge");function Au(){var t=T.document;return t?t.documentMode:void 0}var Ps;e:{if(vr="",Er=function(){var t=Or();if(Tu)return/rv:([^\);]+)(\)|;)/.exec(t);if(wu)return/Edge\/([\d\.]+)/.exec(t);if(Pt)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(ip)return/WebKit\/(\S+)/.exec(t);if(rp)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Er&&(vr=Er?Er[1]:""),Pt&&(wr=Au(),wr!=null&&wr>parseFloat(vr))){Ps=String(wr);break e}Ps=vr}var vr,Er,wr,Cs;T.document&&Pt?(Ts=Au(),Cs=Ts||parseInt(Ps,10)||void 0):Cs=void 0;var Ts,sp=Cs;function In(t,e){if(ne.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Tu){e:{try{js(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:op[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&In.$.h.call(this)}}Q(In,ne);var op={2:"touch",3:"pen",4:"mouse"};In.prototype.h=function(){In.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var bn="closure_listenable_"+(1e6*Math.random()|0),ap=0;function cp(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++ap,this.fa=this.ia=!1}function xr(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Ws(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function up(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function Su(t){let e={};for(let n in t)e[n]=t[n];return e}var lu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ru(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<lu.length;s++)n=lu[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Vr(t){this.src=t,this.g={},this.h=0}Vr.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=ks(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new cp(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Ds(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=Eu(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(xr(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function ks(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var Ks="closure_lm_"+(1e6*Math.random()|0),As={};function bu(t,e,n,r,i){if(r&&r.once)return Cu(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)bu(t,e[s],n,r,i);return null}return n=Ys(n),t&&t[bn]?t.O(e,n,Rn(r)?!!r.capture:!!r,i):Pu(t,e,n,!1,r,i)}function Pu(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Rn(i)?!!i.capture:!!i,a=Qs(t);if(a||(t[Ks]=a=new Vr(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=lp(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)tp||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ku(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function lp(){function t(n){return e.call(t.src,t.listener,n)}let e=hp;return t}function Cu(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Cu(t,e[s],n,r,i);return null}return n=Ys(n),t&&t[bn]?t.P(e,n,Rn(r)?!!r.capture:!!r,i):Pu(t,e,n,!0,r,i)}function Du(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Du(t,e[s],n,r,i);else r=Rn(r)?!!r.capture:!!r,n=Ys(n),t&&t[bn]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=ks(s,n,r,i),-1<n&&(xr(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Qs(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ks(e,n,r,i)),(n=-1<t?e[t]:null)&&Hs(n))}function Hs(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[bn])Ds(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ku(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Qs(e))?(Ds(n,t),n.h==0&&(n.src=null,e[Ks]=null)):xr(t)}}}function ku(t){return t in As?As[t]:As[t]="on"+t}function hp(t,e){if(t.fa)t=!0;else{e=new In(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Hs(t),t=n.call(r,e)}return t}function Qs(t){return t=t[Ks],t instanceof Vr?t:null}var Ss="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ys(t){return typeof t=="function"?t:(t[Ss]||(t[Ss]=function(e){return t.handleEvent(e)}),t[Ss])}function H(){ze.call(this),this.i=new Vr(this),this.S=this,this.J=null}Q(H,ze);H.prototype[bn]=!0;H.prototype.removeEventListener=function(t,e,n,r){Du(this,t,e,n,r)};function X(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new ne(e,t);else if(e instanceof ne)e.target=e.target||t;else{var i=e;e=new ne(r,t),Ru(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Tr(o,r,!0,e)&&i}if(o=e.g=t,i=Tr(o,r,!0,e)&&i,i=Tr(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Tr(o,r,!1,e)&&i}H.prototype.N=function(){if(H.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)xr(n[r]);delete t.g[e],t.h--}}this.J=null};H.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};H.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Tr(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Ds(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var Js=T.JSON.stringify,Ns=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function dp(){var t=Xs;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Os=class{constructor(){this.h=this.g=null}add(e,n){let r=Nu.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},Nu=new Ns(()=>new xs,t=>t.reset()),xs=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function fp(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function pp(t){T.setTimeout(()=>{throw t},0)}var vn,En=!1,Xs=new Os,Ou=()=>{let t=T.Promise.resolve(void 0);vn=()=>{t.then(mp)}},mp=()=>{for(var t;t=dp();){try{t.h.call(t.g)}catch(n){pp(n)}var e=Nu;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}En=!1};function Lr(t,e){H.call(this),this.h=t||1,this.g=e||T,this.j=te(this.qb,this),this.l=Date.now()}Q(Lr,H);_=Lr.prototype;_.ga=!1;_.T=null;_.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),X(this,"tick"),this.ga&&(Zs(this),this.start()))}};_.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Zs(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}_.N=function(){Lr.$.N.call(this),Zs(this),delete this.g};function eo(t,e,n){if(typeof t=="function")n&&(t=te(t,n));else if(t&&typeof t.handleEvent=="function")t=te(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:T.setTimeout(t,e||0)}function xu(t){t.g=eo(()=>{t.g=null,t.i&&(t.i=!1,xu(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Vs=class extends ze{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:xu(this)}N(){super.N(),this.g&&(T.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function wn(t){ze.call(this),this.h=t,this.g={}}Q(wn,ze);var hu=[];function Vu(t,e,n,r){Array.isArray(n)||(n&&(hu[0]=n.toString()),n=hu);for(var i=0;i<n.length;i++){var s=bu(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Lu(t){Ws(t.g,function(e,n){this.g.hasOwnProperty(n)&&Hs(e)},t),t.g={}}wn.prototype.N=function(){wn.$.N.call(this),Lu(this)};wn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Mr(){this.g=!0}Mr.prototype.Ea=function(){this.g=!1};function gp(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&h[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function _p(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Rt(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Ip(t,n)+(r?" "+r:"")})}function yp(t,e){t.info(function(){return"TIMEOUT: "+e})}Mr.prototype.info=function(){};function Ip(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Js(n)}catch{return e}}var st={},du=null;function Fr(){return du=du||new H}st.Ta="serverreachability";function Mu(t){ne.call(this,st.Ta,t)}Q(Mu,ne);function Tn(t){let e=Fr();X(e,new Mu(e))}st.STAT_EVENT="statevent";function Fu(t,e){ne.call(this,st.STAT_EVENT,t),this.stat=e}Q(Fu,ne);function se(t){let e=Fr();X(e,new Fu(e,t))}st.Ua="timingevent";function Uu(t,e){ne.call(this,st.Ua,t),this.size=e}Q(Uu,ne);function Pn(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return T.setTimeout(function(){t()},e)}var Ur={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Bu={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function to(){}to.prototype.h=null;function fu(t){return t.h||(t.h=t.i())}function qu(){}var Cn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function no(){ne.call(this,"d")}Q(no,ne);function ro(){ne.call(this,"c")}Q(ro,ne);var Ls;function Br(){}Q(Br,to);Br.prototype.g=function(){return new XMLHttpRequest};Br.prototype.i=function(){return{}};Ls=new Br;function Dn(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new wn(this),this.P=vp,t=bs?125:void 0,this.V=new Lr(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new $u}function $u(){this.i=null,this.g="",this.h=!1}var vp=45e3,zu={},Ms={};_=Dn.prototype;_.setTimeout=function(t){this.P=t};function Fs(t,e,n){t.L=1,t.A=$r(Ve(e)),t.u=n,t.S=!0,Gu(t,null)}function Gu(t,e){t.G=Date.now(),kn(t),t.B=Ve(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),Xu(n.i,"t",r),t.o=0,n=t.l.J,t.h=new $u,t.g=Il(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Vs(te(t.Pa,t,t.g),t.O)),Vu(t.U,t.g,"readystatechange",t.nb),e=t.I?Su(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Tn(),gp(t.j,t.v,t.B,t.m,t.W,t.u)}_.nb=function(t){t=t.target;let e=this.M;e&&Te(t)==3?e.l():this.Pa(t)};_.Pa=function(t){try{if(t==this.g)e:{let l=Te(this.g);var e=this.g.Ia();let h=this.g.da();if(!(3>l)&&(l!=3||bs||this.g&&(this.h.h||this.g.ja()||_u(this.g)))){this.J||l!=4||e==7||(e==8||0>=h?Tn(3):Tn(2)),qr(this);var n=this.g.da();this.ca=n;t:if(ju(this)){var r=_u(this.g);t="";var i=r.length,s=Te(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){nt(this),_n(this);var o="";break t}this.h.i=new T.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,_p(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!yn(a)){var u=a;break t}}u=null}if(n=u)Rt(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Us(this,n);else{this.i=!1,this.s=3,se(12),nt(this),_n(this);break e}}this.S?(Wu(this,l,o),bs&&this.i&&l==3&&(Vu(this.U,this.V,"tick",this.mb),this.V.start())):(Rt(this.j,this.m,o,null),Us(this,o)),l==4&&nt(this),this.i&&!this.J&&(l==4?ml(this.l,this):(this.i=!1,kn(this)))}else qp(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,se(12)):(this.s=0,se(13)),nt(this),_n(this)}}}catch{}finally{}};function ju(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function Wu(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=Ep(t,n),i==Ms){e==4&&(t.s=4,se(14),r=!1),Rt(t.j,t.m,null,"[Incomplete Response]");break}else if(i==zu){t.s=4,se(15),Rt(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Rt(t.j,t.m,i,null),Us(t,i);ju(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,se(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),uo(e),e.M=!0,se(11))):(Rt(t.j,t.m,n,"[Invalid Chunked Response]"),nt(t),_n(t))}_.mb=function(){if(this.g){var t=Te(this.g),e=this.g.ja();this.o<e.length&&(qr(this),Wu(this,t,e),this.i&&t!=4&&kn(this))}};function Ep(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Ms:(n=Number(e.substring(n,r)),isNaN(n)?zu:(r+=1,r+n>e.length?Ms:(e=e.slice(r,r+n),t.o=r+n,e)))}_.cancel=function(){this.J=!0,nt(this)};function kn(t){t.Y=Date.now()+t.P,Ku(t,t.P)}function Ku(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Pn(te(t.lb,t),e)}function qr(t){t.C&&(T.clearTimeout(t.C),t.C=null)}_.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(yp(this.j,this.B),this.L!=2&&(Tn(),se(17)),nt(this),this.s=2,_n(this)):Ku(this,this.Y-t)};function _n(t){t.l.H==0||t.J||ml(t.l,t)}function nt(t){qr(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Zs(t.V),Lu(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Us(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Bs(n.i,t))){if(!t.K&&Bs(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Pr(n),jr(n);else break e;co(n),se(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Pn(te(n.ib,n),6e3));if(1>=tl(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else rt(n,11)}else if((t.K||n.g==t)&&Pr(n),!yn(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));let f=u[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let m=t.g;if(m){let S=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(S){var s=r.i;s.g||S.indexOf("spdy")==-1&&S.indexOf("quic")==-1&&S.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(io(s,s.h),s.h=null))}if(r.F){let A=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;A&&(r.Da=A,L(r.I,r.F,A))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=yl(r,r.J?r.pa:null,r.Y),o.K){nl(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(qr(a),kn(a)),r.g=o}else fl(r);0<n.j.length&&Wr(n)}else u[0]!="stop"&&u[0]!="close"||rt(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?rt(n,7):ao(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Tn(4)}catch{}}function wp(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Nr(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Tp(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Nr(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function Hu(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Nr(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=Tp(t),r=wp(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var Qu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ap(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function it(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof it){this.h=t.h,Rr(this,t.j),this.s=t.s,this.g=t.g,br(this,t.m),this.l=t.l;var e=t.i,n=new An;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),pu(this,n),this.o=t.o}else t&&(e=String(t).match(Qu))?(this.h=!1,Rr(this,e[1]||"",!0),this.s=mn(e[2]||""),this.g=mn(e[3]||"",!0),br(this,e[4]),this.l=mn(e[5]||"",!0),pu(this,e[6]||"",!0),this.o=mn(e[7]||"")):(this.h=!1,this.i=new An(null,this.h))}it.prototype.toString=function(){var t=[],e=this.j;e&&t.push(gn(e,mu,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(gn(e,mu,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(gn(n,n.charAt(0)=="/"?bp:Rp,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",gn(n,Cp)),t.join("")};function Ve(t){return new it(t)}function Rr(t,e,n){t.j=n?mn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function br(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function pu(t,e,n){e instanceof An?(t.i=e,Dp(t.i,t.h)):(n||(e=gn(e,Pp)),t.i=new An(e,t.h))}function L(t,e,n){t.i.set(e,n)}function $r(t){return L(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function mn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function gn(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,Sp),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Sp(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var mu=/[#\/\?@]/g,Rp=/[#\?:]/g,bp=/[#\?]/g,Pp=/[#\?@]/g,Cp=/#/g;function An(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ge(t){t.g||(t.g=new Map,t.h=0,t.i&&Ap(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}_=An.prototype;_.add=function(t,e){Ge(this),this.i=null,t=Ct(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Yu(t,e){Ge(t),e=Ct(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ju(t,e){return Ge(t),e=Ct(t,e),t.g.has(e)}_.forEach=function(t,e){Ge(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};_.ta=function(){Ge(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};_.Z=function(t){Ge(this);let e=[];if(typeof t=="string")Ju(this,t)&&(e=e.concat(this.g.get(Ct(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};_.set=function(t,e){return Ge(this),this.i=null,t=Ct(this,t),Ju(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};_.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function Xu(t,e,n){Yu(t,e),0<n.length&&(t.i=null,t.g.set(Ct(t,e),Gs(n)),t.h+=n.length)}_.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ct(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Dp(t,e){e&&!t.j&&(Ge(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(Yu(this,r),Xu(this,i,n))},t)),t.j=e}var kp=class{constructor(t,e){this.g=t,this.map=e}};function Zu(t){this.l=t||Np,T.PerformanceNavigationTiming?(t=T.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(T.g&&T.g.Ka&&T.g.Ka()&&T.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Np=10;function el(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function tl(t){return t.h?1:t.g?t.g.size:0}function Bs(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function io(t,e){t.g?t.g.add(e):t.h=e}function nl(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Zu.prototype.cancel=function(){if(this.i=rl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function rl(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return Gs(t.i)}var Op=class{stringify(t){return T.JSON.stringify(t,void 0)}parse(t){return T.JSON.parse(t,void 0)}};function xp(){this.g=new Op}function Vp(t,e,n){let r=n||"";try{Hu(t,function(i,s){let o=i;Rn(i)&&(o=Js(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Lp(t,e){let n=new Mr;if(T.Image){let r=new Image;r.onload=Ir(Ar,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ir(Ar,n,r,"TestLoadImage: error",!1,e),r.onabort=Ir(Ar,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ir(Ar,n,r,"TestLoadImage: timeout",!1,e),T.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Ar(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Nn(t){this.l=t.ec||null,this.j=t.ob||!1}Q(Nn,to);Nn.prototype.g=function(){return new zr(this.l,this.j)};Nn.prototype.i=function(t){return function(){return t}}({});function zr(t,e){H.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=so,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Q(zr,H);var so=0;_=zr.prototype;_.open=function(t,e){if(this.readyState!=so)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Sn(this)};_.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||T).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};_.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,On(this)),this.readyState=so};_.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Sn(this)),this.g&&(this.readyState=3,Sn(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof T.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;il(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function il(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}_.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?On(this):Sn(this),this.readyState==3&&il(this)}};_.Za=function(t){this.g&&(this.response=this.responseText=t,On(this))};_.Ya=function(t){this.g&&(this.response=t,On(this))};_.ka=function(){this.g&&On(this)};function On(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Sn(t)}_.setRequestHeader=function(t,e){this.v.append(t,e)};_.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};_.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Sn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(zr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Mp=T.JSON.parse;function U(t){H.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=sl,this.L=this.M=!1}Q(U,H);var sl="",Fp=/^https?$/i,Up=["POST","PUT"];_=U.prototype;_.Oa=function(t){this.M=t};_.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ls.g(),this.C=this.u?fu(this.u):fu(Ls),this.g.onreadystatechange=te(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){gu(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=T.FormData&&t instanceof T.FormData,!(0<=Eu(Up,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{cl(this),0<this.B&&((this.L=Bp(this.g))?(this.g.timeout=this.B,this.g.ontimeout=te(this.ua,this)):this.A=eo(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){gu(this,s)}};function Bp(t){return Pt&&typeof t.timeout=="number"&&t.ontimeout!==void 0}_.ua=function(){typeof zs<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,X(this,"timeout"),this.abort(8))};function gu(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,ol(t),Gr(t)}function ol(t){t.F||(t.F=!0,X(t,"complete"),X(t,"error"))}_.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,X(this,"complete"),X(this,"abort"),Gr(this))};_.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Gr(this,!0)),U.$.N.call(this)};_.La=function(){this.s||(this.G||this.v||this.l?al(this):this.kb())};_.kb=function(){al(this)};function al(t){if(t.h&&typeof zs<"u"&&(!t.C[1]||Te(t)!=4||t.da()!=2)){if(t.v&&Te(t)==4)eo(t.La,0,t);else if(X(t,"readystatechange"),Te(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(Qu)[1]||null;!i&&T.self&&T.self.location&&(i=T.self.location.protocol.slice(0,-1)),r=!Fp.test(i?i.toLowerCase():"")}n=r}if(n)X(t,"complete"),X(t,"success");else{t.m=6;try{var s=2<Te(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",ol(t)}}finally{Gr(t)}}}}function Gr(t,e){if(t.g){cl(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||X(t,"ready");try{n.onreadystatechange=r}catch{}}}function cl(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(T.clearTimeout(t.A),t.A=null)}_.isActive=function(){return!!this.g};function Te(t){return t.g?t.g.readyState:0}_.da=function(){try{return 2<Te(this)?this.g.status:-1}catch{return-1}};_.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};_.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Mp(e)}};function _u(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case sl:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function qp(t){let e={};t=(t.g&&2<=Te(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(yn(t[r]))continue;var n=fp(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}up(e,function(r){return r.join(", ")})}_.Ia=function(){return this.m};_.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function ul(t){let e="";return Ws(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function oo(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=ul(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):L(t,e,n))}function fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ll(t){this.Ga=0,this.j=[],this.l=new Mr,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=fn("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=fn("baseRetryDelayMs",5e3,t),this.hb=fn("retryDelaySeedMs",1e4,t),this.eb=fn("forwardChannelMaxRetries",2,t),this.xa=fn("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Zu(t&&t.concurrentRequestLimit),this.Ja=new xp,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}_=ll.prototype;_.ra=8;_.H=1;function ao(t){if(hl(t),t.H==3){var e=t.W++,n=Ve(t.I);if(L(n,"SID",t.K),L(n,"RID",e),L(n,"TYPE","terminate"),xn(t,n),e=new Dn(t,t.l,e),e.L=2,e.A=$r(Ve(n)),n=!1,T.navigator&&T.navigator.sendBeacon)try{n=T.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&T.Image&&(new Image().src=e.A,n=!0),n||(e.g=Il(e.l,null),e.g.ha(e.A)),e.G=Date.now(),kn(e)}_l(t)}function jr(t){t.g&&(uo(t),t.g.cancel(),t.g=null)}function hl(t){jr(t),t.u&&(T.clearTimeout(t.u),t.u=null),Pr(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&T.clearTimeout(t.m),t.m=null)}function Wr(t){if(!el(t.i)&&!t.m){t.m=!0;var e=t.Na;vn||Ou(),En||(vn(),En=!0),Xs.add(e,t),t.C=0}}function $p(t,e){return tl(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Pn(te(t.Na,t,e),gl(t,t.C)),t.C++,!0)}_.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Dn(this,this.l,t),s=this.s;if(this.U&&(s?(s=Su(s),Ru(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=dl(this,i,e),n=Ve(this.I),L(n,"RID",t),L(n,"CVER",22),this.F&&L(n,"X-HTTP-Session-Id",this.F),xn(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(ul(s)))+"&"+e:this.o&&oo(n,this.o,s)),io(this.i,i),this.bb&&L(n,"TYPE","init"),this.P?(L(n,"$req",e),L(n,"SID","null"),i.aa=!0,Fs(i,n,null)):Fs(i,n,e),this.H=2}}else this.H==3&&(t?yu(this,t):this.j.length==0||el(this.i)||yu(this))};function yu(t,e){var n;e?n=e.m:n=t.W++;let r=Ve(t.I);L(r,"SID",t.K),L(r,"RID",n),L(r,"AID",t.V),xn(t,r),t.o&&t.s&&oo(r,t.o,t.s),n=new Dn(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=dl(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),io(t.i,n),Fs(n,r,e)}function xn(t,e){t.na&&Ws(t.na,function(n,r){L(e,r,n)}),t.h&&Hu({},function(n,r){L(e,r,n)})}function dl(t,e,n){n=Math.min(t.j.length,n);var r=t.h?te(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{Vp(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function fl(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;vn||Ou(),En||(vn(),En=!0),Xs.add(e,t),t.A=0}}function co(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Pn(te(t.Ma,t),gl(t,t.A)),t.A++,!0)}_.Ma=function(){if(this.u=null,pl(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Pn(te(this.jb,this),t)}};_.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,se(10),jr(this),pl(this))};function uo(t){t.B!=null&&(T.clearTimeout(t.B),t.B=null)}function pl(t){t.g=new Dn(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ve(t.wa);L(e,"RID","rpc"),L(e,"SID",t.K),L(e,"AID",t.V),L(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&L(e,"TO",t.qa),L(e,"TYPE","xmlhttp"),xn(t,e),t.o&&t.s&&oo(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=$r(Ve(e)),n.u=null,n.S=!0,Gu(n,t)}_.ib=function(){this.v!=null&&(this.v=null,jr(this),co(this),se(19))};function Pr(t){t.v!=null&&(T.clearTimeout(t.v),t.v=null)}function ml(t,e){var n=null;if(t.g==e){Pr(t),uo(t),t.g=null;var r=2}else if(Bs(t.i,e))n=e.F,nl(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=Fr(),X(r,new Uu(r,n)),Wr(t)}else fl(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&$p(t,e)||r==2&&co(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:rt(t,5);break;case 4:rt(t,10);break;case 3:rt(t,6);break;default:rt(t,2)}}}function gl(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function rt(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=te(t.pb,t);n||(n=new it("//www.google.com/images/cleardot.gif"),T.location&&T.location.protocol=="http"||Rr(n,"https"),$r(n)),Lp(n.toString(),r)}else se(2);t.H=0,t.h&&t.h.za(e),_l(t),hl(t)}_.pb=function(t){t?(this.l.info("Successfully pinged google.com"),se(2)):(this.l.info("Failed to ping google.com"),se(1))};function _l(t){if(t.H=0,t.ma=[],t.h){let e=rl(t.i);(e.length!=0||t.j.length!=0)&&(uu(t.ma,e),uu(t.ma,t.j),t.i.i.length=0,Gs(t.j),t.j.length=0),t.h.ya()}}function yl(t,e,n){var r=n instanceof it?Ve(n):new it(n);if(r.g!="")e&&(r.g=e+"."+r.g),br(r,r.m);else{var i=T.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new it(null);r&&Rr(s,r),e&&(s.g=e),i&&br(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&L(r,n,e),L(r,"VER",t.ra),xn(t,r),r}function Il(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new U(new Nn({ob:n})):new U(t.va),e.Oa(t.J),e}_.isActive=function(){return!!this.h&&this.h.isActive(this)};function vl(){}_=vl.prototype;_.Ba=function(){};_.Aa=function(){};_.za=function(){};_.ya=function(){};_.isActive=function(){return!0};_.Va=function(){};function Cr(){if(Pt&&!(10<=Number(sp)))throw Error("Environmental error: no available transport.")}Cr.prototype.g=function(t,e){return new ae(t,e)};function ae(t,e){H.call(this),this.g=new ll(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!yn(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!yn(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Dt(this)}Q(ae,H);ae.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;se(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=yl(t,null,t.Y),Wr(t)};ae.prototype.close=function(){ao(this.g)};ae.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Js(t),t=n);e.j.push(new kp(e.fb++,t)),e.H==3&&Wr(e)};ae.prototype.N=function(){this.g.h=null,delete this.j,ao(this.g),delete this.g,ae.$.N.call(this)};function El(t){no.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Q(El,no);function wl(){ro.call(this),this.status=1}Q(wl,ro);function Dt(t){this.g=t}Q(Dt,vl);Dt.prototype.Ba=function(){X(this.g,"a")};Dt.prototype.Aa=function(t){X(this.g,new El(t))};Dt.prototype.za=function(t){X(this.g,new wl)};Dt.prototype.ya=function(){X(this.g,"b")};function zp(){this.blockSize=-1}function me(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Q(me,zp);me.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Rs(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}me.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Rs(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Rs(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Rs(this,r),i=0;break}}this.h=i,this.i+=e};me.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function N(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var Gp={};function lo(t){return-128<=t&&128>t?np(t,function(e){return new N([e|0],0>e?-1:0)}):new N([t|0],0>t?-1:0)}function Ae(t){if(isNaN(t)||!isFinite(t))return bt;if(0>t)return J(Ae(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=qs;return new N(e,0)}function Tl(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return J(Tl(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ae(Math.pow(e,8)),r=bt,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Ae(Math.pow(e,s)),r=r.R(s).add(Ae(o))):(r=r.R(n),r=r.add(Ae(o)))}return r}var qs=4294967296,bt=lo(0),$s=lo(1),Iu=lo(16777216);_=N.prototype;_.ea=function(){if(pe(this))return-J(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:qs+r)*e,e*=qs}return t};_.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(xe(this))return"0";if(pe(this))return"-"+J(this).toString(t);for(var e=Ae(Math.pow(t,6)),n=this,r="";;){var i=kr(n,e).g;n=Dr(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,xe(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};_.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function xe(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function pe(t){return t.h==-1}_.X=function(t){return t=Dr(this,t),pe(t)?-1:xe(t)?0:1};function J(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new N(n,~t.h).add($s)}_.abs=function(){return pe(this)?J(this):this};_.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new N(n,n[n.length-1]&-2147483648?-1:0)};function Dr(t,e){return t.add(J(e))}_.R=function(t){if(xe(this)||xe(t))return bt;if(pe(this))return pe(t)?J(this).R(J(t)):J(J(this).R(t));if(pe(t))return J(this.R(J(t)));if(0>this.X(Iu)&&0>t.X(Iu))return Ae(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,Sr(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Sr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Sr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Sr(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new N(n,0)};function Sr(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function pn(t,e){this.g=t,this.h=e}function kr(t,e){if(xe(e))throw Error("division by zero");if(xe(t))return new pn(bt,bt);if(pe(t))return e=kr(J(t),e),new pn(J(e.g),J(e.h));if(pe(e))return e=kr(t,J(e)),new pn(J(e.g),e.h);if(30<t.g.length){if(pe(t)||pe(e))throw Error("slowDivide_ only works with positive integers.");for(var n=$s,r=e;0>=r.X(t);)n=vu(n),r=vu(r);var i=St(n,1),s=St(r,1);for(r=St(r,2),n=St(n,2);!xe(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=St(r,1),n=St(n,1)}return e=Dr(t,i.R(e)),new pn(i,e)}for(i=bt;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ae(n),o=s.R(e);pe(o)||0<o.X(t);)n-=r,s=Ae(n),o=s.R(e);xe(s)&&(s=$s),i=i.add(s),t=Dr(t,o)}return new pn(i,t)}_.gb=function(t){return kr(this,t).h};_.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new N(n,this.h&t.h)};_.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new N(n,this.h|t.h)};_.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new N(n,this.h^t.h)};function vu(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new N(n,t.h)}function St(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new N(i,t.h)}Cr.prototype.createWebChannel=Cr.prototype.g;ae.prototype.send=ae.prototype.u;ae.prototype.open=ae.prototype.m;ae.prototype.close=ae.prototype.close;Ur.NO_ERROR=0;Ur.TIMEOUT=8;Ur.HTTP_ERROR=6;Bu.COMPLETE="complete";qu.EventType=Cn;Cn.OPEN="a";Cn.CLOSE="b";Cn.ERROR="c";Cn.MESSAGE="d";H.prototype.listen=H.prototype.O;U.prototype.listenOnce=U.prototype.P;U.prototype.getLastError=U.prototype.Sa;U.prototype.getLastErrorCode=U.prototype.Ia;U.prototype.getStatus=U.prototype.da;U.prototype.getResponseJson=U.prototype.Wa;U.prototype.getResponseText=U.prototype.ja;U.prototype.send=U.prototype.ha;U.prototype.setWithCredentials=U.prototype.Oa;me.prototype.digest=me.prototype.l;me.prototype.reset=me.prototype.reset;me.prototype.update=me.prototype.j;N.prototype.add=N.prototype.add;N.prototype.multiply=N.prototype.R;N.prototype.modulo=N.prototype.gb;N.prototype.compare=N.prototype.X;N.prototype.toNumber=N.prototype.ea;N.prototype.toString=N.prototype.toString;N.prototype.getBits=N.prototype.D;N.fromNumber=Ae;N.fromString=Tl;var Al=ge.createWebChannelTransport=function(){return new Cr},Sl=ge.getStatEventTarget=function(){return Fr()},Kr=ge.ErrorCode=Ur,Rl=ge.EventType=Bu,bl=ge.Event=st,ho=ge.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},lI=ge.FetchXmlHttpFactory=Nn,Vn=ge.WebChannel=qu,Pl=ge.XhrIo=U,Cl=ge.Md5=me,ot=ge.Integer=N;var Dl="@firebase/firestore";var Y=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Y.UNAUTHENTICATED=new Y(null),Y.GOOGLE_CREDENTIALS=new Y("google-credentials-uid"),Y.FIRST_PARTY=new Y("first-party-uid"),Y.MOCK_USER=new Y("mock-user");var Zt="10.7.0";var ut=new Be("@firebase/firestore");function Ln(){return ut.logLevel}function I(t,...e){if(ut.logLevel<=P.DEBUG){let n=e.map(Za);ut.debug(`Firestore (${Zt}): ${t}`,...n)}}function Le(t,...e){if(ut.logLevel<=P.ERROR){let n=e.map(Za);ut.error(`Firestore (${Zt}): ${t}`,...n)}}function Ft(t,...e){if(ut.logLevel<=P.WARN){let n=e.map(Za);ut.warn(`Firestore (${Zt}): ${t}`,...n)}}function Za(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function w(t="Unexpected state"){let e=`FIRESTORE (${Zt}) INTERNAL ASSERTION FAILED: `+t;throw Le(e),new Error(e)}function V(t,e){t||w()}function b(t,e){return t}var p={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},y=class extends le{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var be=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Xr=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},_o=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Y.UNAUTHENTICATED))}shutdown(){}},yo=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Io=class{constructor(e){this.t=e,this.currentUser=Y.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new be;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new be,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>d(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{I("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(I("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new be)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(I("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(V(typeof r.accessToken=="string"),new Xr(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return V(e===null||typeof e=="string"),new Y(e)}},vo=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Y.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Eo=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new vo(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Y.FIRST_PARTY))}shutdown(){}invalidateToken(){}},wo=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},To=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&I("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,I("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{I("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):I("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(V(typeof n.token=="string"),this.R=n.token,new wo(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function Wp(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Zr=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Wp(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function k(t,e){return t<e?-1:t>e?1:0}function Ut(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}var Z=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new y(p.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new y(p.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new y(p.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new y(p.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?k(this.nanoseconds,e.nanoseconds):k(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var R=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Z(0,0))}static max(){return new t(new Z(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ei=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&w(),r===void 0?r=e.length-n:r>e.length-n&&w(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},F=class t extends ei{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new y(p.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},Kp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ce=class t extends ei{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return Kp.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new y(p.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new y(p.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new y(p.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new y(p.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var E=class t{constructor(e){this.path=e}static fromPath(e){return new t(F.fromString(e))}static fromName(e){return new t(F.fromString(e).popFirst(5))}static empty(){return new t(F.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&F.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return F.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new F(e.slice()))}};var Ao=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};Ao.UNKNOWN_ID=-1;function Hp(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=R.fromTimestamp(r===1e9?new Z(n+1,0):new Z(n,r));return new lt(i,E.empty(),e)}function Qp(t){return new lt(t.readTime,t.key,-1)}var lt=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(R.min(),E.empty(),-1)}static max(){return new t(R.max(),E.empty(),-1)}};function Yp(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=E.comparator(t.documentKey,e.documentKey),n!==0?n:k(t.largestBatchId,e.largestBatchId))}var Jp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",So=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function er(t){return d(this,null,function*(){if(t.code!==p.FAILED_PRECONDITION||t.message!==Jp)throw t;I("LocalStore","Unexpectedly lost primary lease")})}var g=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&w(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};function tr(t){return t.name==="IndexedDbTransactionError"}var oh=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Si(t){return t==null}function $n(t){return t===0&&1/t==-1/0}function Xp(t){return typeof t=="number"&&Number.isInteger(t)&&!$n(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Zp=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],EI=[...Zp,"documentOverlays"],em=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],tm=em,wI=[...tm,"indexConfiguration","indexState","indexEntries"];function kl(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function en(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ah(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var q=class t{constructor(e,n){this.comparator=e,this.root=n||Pe.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Pe.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pe.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xt(this.root,e,this.comparator,!1)}getReverseIterator(){return new xt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xt(this.root,e,this.comparator,!0)}},xt=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Pe=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw w();let e=this.left.check();if(e!==this.right.check())throw w();return e+(this.isRed()?0:1)}};Pe.EMPTY=null,Pe.RED=!0,Pe.BLACK=!1;Pe.EMPTY=new class{constructor(){this.size=0}get key(){throw w()}get value(){throw w()}get color(){throw w()}get left(){throw w()}get right(){throw w()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Pe(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ie=class t{constructor(e){this.comparator=e,this.data=new q(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ti(this.data.getIterator())}getIteratorFrom(e){return new ti(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},ti=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Re=class t{constructor(e){this.fields=e,e.sort(ce.comparator)}static empty(){return new t([])}unionWith(e){let n=new ie(ce.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ut(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var ni=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var oe=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ni("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return k(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};oe.EMPTY_BYTE_STRING=new oe("");var nm=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ke(t){if(V(!!t),typeof t=="string"){let e=0,n=nm.exec(t);if(V(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:B(t.seconds),nanos:B(t.nanos)}}function B(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function He(t){return typeof t=="string"?oe.fromBase64String(t):oe.fromUint8Array(t)}function ec(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function tc(t){let e=t.mapValue.fields.__previous_value__;return ec(e)?tc(e):e}function zn(t){let e=Ke(t.mapValue.fields.__local_write_time__.timestampValue);return new Z(e.seconds,e.nanos)}var Ro=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},ri=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Hr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ht(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ec(t)?4:ch(t)?9007199254740991:10:w()}function ke(t,e){if(t===e)return!0;let n=ht(t);if(n!==ht(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zn(t).isEqual(zn(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Ke(i.timestampValue),a=Ke(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return He(i.bytesValue).isEqual(He(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return B(i.geoPointValue.latitude)===B(s.geoPointValue.latitude)&&B(i.geoPointValue.longitude)===B(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return B(i.integerValue)===B(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=B(i.doubleValue),a=B(s.doubleValue);return o===a?$n(o)===$n(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ut(t.arrayValue.values||[],e.arrayValue.values||[],ke);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(kl(o)!==kl(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!ke(o[c],a[c])))return!1;return!0}(t,e);default:return w()}}function Gn(t,e){return(t.values||[]).find(n=>ke(n,e))!==void 0}function Bt(t,e){if(t===e)return 0;let n=ht(t),r=ht(e);if(n!==r)return k(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return k(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=B(s.integerValue||s.doubleValue),c=B(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return Nl(t.timestampValue,e.timestampValue);case 4:return Nl(zn(t),zn(e));case 5:return k(t.stringValue,e.stringValue);case 6:return function(s,o){let a=He(s),c=He(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=k(a[u],c[u]);if(l!==0)return l}return k(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=k(B(s.latitude),B(o.latitude));return a!==0?a:k(B(s.longitude),B(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=Bt(a[u],c[u]);if(l)return l}return k(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Hr.mapValue&&o===Hr.mapValue)return 0;if(s===Hr.mapValue)return 1;if(o===Hr.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let h=0;h<c.length&&h<l.length;++h){let f=k(c[h],l[h]);if(f!==0)return f;let m=Bt(a[c[h]],u[l[h]]);if(m!==0)return m}return k(c.length,l.length)}(t.mapValue,e.mapValue);default:throw w()}}function Nl(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return k(t,e);let n=Ke(t),r=Ke(e),i=k(n.seconds,r.seconds);return i!==0?i:k(n.nanos,r.nanos)}function qt(t){return bo(t)}function bo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Ke(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return He(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return E.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=bo(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${bo(n.fields[o])}`;return i+"}"}(t.mapValue):w()}function Ol(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Po(t){return!!t&&"integerValue"in t}function nc(t){return!!t&&"arrayValue"in t}function xl(t){return!!t&&"nullValue"in t}function Vl(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yr(t){return!!t&&"mapValue"in t}function Fn(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return en(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Fn(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fn(t.arrayValue.values[n]);return e}return Object.assign({},t)}function ch(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var _e=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Yr(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fn(n)}setAll(e){let n=ce.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Fn(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Yr(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ke(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Yr(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){en(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Fn(this.value))}};function uh(t){let e=[];return en(t.fields,(n,r)=>{let i=new ce([n]);if(Yr(r)){let s=uh(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Re(e)}var ye=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,R.min(),R.min(),R.min(),_e.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,R.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,R.min(),R.min(),_e.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,R.min(),R.min(),_e.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(R.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_e.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_e.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=R.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var $t=class{constructor(e,n){this.position=e,this.inclusive=n}};function Ll(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=E.comparator(E.fromName(o.referenceValue),n.key):r=Bt(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ml(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ke(t.position[n],e.position[n]))return!1;return!0}var zt=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function rm(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var ii=class{},j=class t extends ii{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Do(e,n,r):n==="array-contains"?new Oo(e,r):n==="in"?new xo(e,r):n==="not-in"?new Vo(e,r):n==="array-contains-any"?new Lo(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new ko(e,r):new No(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Bt(n,this.value)):n!==null&&ht(this.value)===ht(n)&&this.matchesComparison(Bt(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return w()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ie=class t extends ii{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return lh(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function lh(t){return t.op==="and"}function hh(t){return im(t)&&lh(t)}function im(t){for(let e of t.filters)if(e instanceof Ie)return!1;return!0}function Co(t){if(t instanceof j)return t.field.canonicalString()+t.op.toString()+qt(t.value);if(hh(t))return t.filters.map(e=>Co(e)).join(",");{let e=t.filters.map(n=>Co(n)).join(",");return`${t.op}(${e})`}}function dh(t,e){return t instanceof j?function(r,i){return i instanceof j&&r.op===i.op&&r.field.isEqual(i.field)&&ke(r.value,i.value)}(t,e):t instanceof Ie?function(r,i){return i instanceof Ie&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&dh(o,i.filters[a]),!0):!1}(t,e):void w()}function fh(t){return t instanceof j?function(n){return`${n.field.canonicalString()} ${n.op} ${qt(n.value)}`}(t):t instanceof Ie?function(n){return n.op.toString()+" {"+n.getFilters().map(fh).join(" ,")+"}"}(t):"Filter"}var Do=class extends j{constructor(e,n,r){super(e,n,r),this.key=E.fromName(r.referenceValue)}matches(e){let n=E.comparator(e.key,this.key);return this.matchesComparison(n)}},ko=class extends j{constructor(e,n){super(e,"in",n),this.keys=ph("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},No=class extends j{constructor(e,n){super(e,"not-in",n),this.keys=ph("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function ph(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>E.fromName(r.referenceValue))}var Oo=class extends j{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return nc(n)&&Gn(n.arrayValue,this.value)}},xo=class extends j{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Gn(this.value.arrayValue,n)}},Vo=class extends j{constructor(e,n){super(e,"not-in",n)}matches(e){if(Gn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Gn(this.value.arrayValue,n)}},Lo=class extends j{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!nc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Gn(this.value.arrayValue,r))}};var Mo=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function Fl(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Mo(t,e,n,r,i,s,o)}function rc(t){let e=b(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Co(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Si(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>qt(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>qt(r)).join(",")),e.ce=n}return e.ce}function ic(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!rm(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!dh(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ml(t.startAt,e.startAt)&&Ml(t.endAt,e.endAt)}function Fo(t){return E.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}var dt=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function sm(t,e,n,r,i,s,o,a){return new dt(t,e,n,r,i,s,o,a)}function mh(t){return new dt(t)}function Ul(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function gh(t){return t.collectionGroup!==null}function Un(t){let e=b(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ie(ce.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new zt(s,r))}),n.has(ce.keyField().canonicalString())||e.le.push(new zt(ce.keyField(),r))}return e.le}function Ce(t){let e=b(t);return e.he||(e.he=om(e,Un(t))),e.he}function om(t,e){if(t.limitType==="F")return Fl(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new zt(i.field,s)});let n=t.endAt?new $t(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new $t(t.startAt.position,t.startAt.inclusive):null;return Fl(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Uo(t,e){let n=t.filters.concat([e]);return new dt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Bo(t,e,n){return new dt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ri(t,e){return ic(Ce(t),Ce(e))&&t.limitType===e.limitType}function _h(t){return`${rc(Ce(t))}|lt:${t.limitType}`}function kt(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>fh(i)).join(", ")}]`),Si(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>qt(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>qt(i)).join(",")),`Target(${r})`}(Ce(t))}; limitType=${t.limitType})`}function bi(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):E.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Un(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=Ll(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,Un(r),i)||r.endAt&&!function(o,a,c){let u=Ll(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,Un(r),i))}(t,e)}function am(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function yh(t){return(e,n)=>{let r=!1;for(let i of Un(t)){let s=cm(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function cm(t,e,n){let r=t.field.isKeyField()?E.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Bt(c,u):w()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return w()}}var Qe=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){en(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return ah(this.inner)}size(){return this.innerSize}};var um=new q(E.comparator);function Me(){return um}var Ih=new q(E.comparator);function Mn(...t){let e=Ih;for(let n of t)e=e.insert(n.key,n);return e}function vh(t){let e=Ih;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function at(){return Bn()}function Eh(){return Bn()}function Bn(){return new Qe(t=>t.toString(),(t,e)=>t.isEqual(e))}var lm=new q(E.comparator),hm=new ie(E.comparator);function C(...t){let e=hm;for(let n of t)e=e.add(n);return e}var dm=new ie(k);function fm(){return dm}function wh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$n(e)?"-0":e}}function Th(t){return{integerValue:""+t}}function pm(t,e){return Xp(e)?Th(e):wh(t,e)}var Gt=class{constructor(){this._=void 0}};function mm(t,e,n){return t instanceof jt?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ec(s)&&(s=tc(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ft?Sh(t,e):t instanceof pt?Rh(t,e):function(i,s){let o=Ah(i,s),a=Bl(o)+Bl(i.Ie);return Po(o)&&Po(i.Ie)?Th(a):wh(i.serializer,a)}(t,e)}function gm(t,e,n){return t instanceof ft?Sh(t,e):t instanceof pt?Rh(t,e):n}function Ah(t,e){return t instanceof Wt?function(r){return Po(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var jt=class extends Gt{},ft=class extends Gt{constructor(e){super(),this.elements=e}};function Sh(t,e){let n=bh(e);for(let r of t.elements)n.some(i=>ke(i,r))||n.push(r);return{arrayValue:{values:n}}}var pt=class extends Gt{constructor(e){super(),this.elements=e}};function Rh(t,e){let n=bh(e);for(let r of t.elements)n=n.filter(i=>!ke(i,r));return{arrayValue:{values:n}}}var Wt=class extends Gt{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function Bl(t){return B(t.integerValue||t.doubleValue)}function bh(t){return nc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function _m(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ft&&i instanceof ft||r instanceof pt&&i instanceof pt?Ut(r.elements,i.elements,ke):r instanceof Wt&&i instanceof Wt?ke(r.Ie,i.Ie):r instanceof jt&&i instanceof jt}(t.transform,e.transform)}var qo=class{constructor(e,n){this.version=e,this.transformResults=n}},je=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Jr(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Kt=class{};function Ph(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new jn(t.key,je.none()):new mt(t.key,t.data,je.none());{let n=t.data,r=_e.empty(),i=new ie(ce.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Fe(t.key,r,new Re(i.toArray()),je.none())}}function ym(t,e,n){t instanceof mt?function(i,s,o){let a=i.value.clone(),c=$l(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Fe?function(i,s,o){if(!Jr(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=$l(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Ch(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function qn(t,e,n,r){return t instanceof mt?function(s,o,a,c){if(!Jr(s.precondition,o))return a;let u=s.value.clone(),l=zl(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Fe?function(s,o,a,c){if(!Jr(s.precondition,o))return a;let u=zl(s.fieldTransforms,c,o),l=o.data;return l.setAll(Ch(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return Jr(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function Im(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=Ah(r.transform,i||null);s!=null&&(n===null&&(n=_e.empty()),n.set(r.field,s))}return n||null}function ql(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ut(r,i,(s,o)=>_m(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var mt=class extends Kt{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Fe=class extends Kt{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Ch(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function $l(t,e,n){let r=new Map;V(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,gm(o,a,n[i]))}return r}function zl(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,mm(s,o,e))}return r}var jn=class extends Kt{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},$o=class extends Kt{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var zo=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&ym(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=qn(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=qn(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=Eh();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=Ph(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(R.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),C())}isEqual(e){return this.batchId===e.batchId&&Ut(this.mutations,e.mutations,(n,r)=>ql(n,r))&&Ut(this.baseMutations,e.baseMutations,(n,r)=>ql(n,r))}},Go=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){V(e.mutations.length===r.length);let i=function(){return lm}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var jo=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Wo=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var z,D;function vm(t){switch(t){default:return w();case p.CANCELLED:case p.UNKNOWN:case p.DEADLINE_EXCEEDED:case p.RESOURCE_EXHAUSTED:case p.INTERNAL:case p.UNAVAILABLE:case p.UNAUTHENTICATED:return!1;case p.INVALID_ARGUMENT:case p.NOT_FOUND:case p.ALREADY_EXISTS:case p.PERMISSION_DENIED:case p.FAILED_PRECONDITION:case p.ABORTED:case p.OUT_OF_RANGE:case p.UNIMPLEMENTED:case p.DATA_LOSS:return!0}}function Dh(t){if(t===void 0)return Le("GRPC error has no .code"),p.UNKNOWN;switch(t){case z.OK:return p.OK;case z.CANCELLED:return p.CANCELLED;case z.UNKNOWN:return p.UNKNOWN;case z.DEADLINE_EXCEEDED:return p.DEADLINE_EXCEEDED;case z.RESOURCE_EXHAUSTED:return p.RESOURCE_EXHAUSTED;case z.INTERNAL:return p.INTERNAL;case z.UNAVAILABLE:return p.UNAVAILABLE;case z.UNAUTHENTICATED:return p.UNAUTHENTICATED;case z.INVALID_ARGUMENT:return p.INVALID_ARGUMENT;case z.NOT_FOUND:return p.NOT_FOUND;case z.ALREADY_EXISTS:return p.ALREADY_EXISTS;case z.PERMISSION_DENIED:return p.PERMISSION_DENIED;case z.FAILED_PRECONDITION:return p.FAILED_PRECONDITION;case z.ABORTED:return p.ABORTED;case z.OUT_OF_RANGE:return p.OUT_OF_RANGE;case z.UNIMPLEMENTED:return p.UNIMPLEMENTED;case z.DATA_LOSS:return p.DATA_LOSS;default:return w()}}(D=z||(z={}))[D.OK=0]="OK",D[D.CANCELLED=1]="CANCELLED",D[D.UNKNOWN=2]="UNKNOWN",D[D.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",D[D.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",D[D.NOT_FOUND=5]="NOT_FOUND",D[D.ALREADY_EXISTS=6]="ALREADY_EXISTS",D[D.PERMISSION_DENIED=7]="PERMISSION_DENIED",D[D.UNAUTHENTICATED=16]="UNAUTHENTICATED",D[D.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",D[D.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",D[D.ABORTED=10]="ABORTED",D[D.OUT_OF_RANGE=11]="OUT_OF_RANGE",D[D.UNIMPLEMENTED=12]="UNIMPLEMENTED",D[D.INTERNAL=13]="INTERNAL",D[D.UNAVAILABLE=14]="UNAVAILABLE",D[D.DATA_LOSS=15]="DATA_LOSS";var Gl=null;function Em(){return new TextEncoder}var wm=new ot([4294967295,4294967295],0);function jl(t){let e=Em().encode(t),n=new Cl;return n.update(e),new Uint8Array(n.digest())}function Wl(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ot([n,r],0),new ot([i,s],0)]}var Ko=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ct(`Invalid padding: ${n}`);if(r<0)throw new ct(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ct(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ct(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=ot.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(ot.fromNumber(r)));return i.compare(wm)===1&&(i=new ot([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=jl(e),[r,i]=Wl(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=jl(e),[r,i]=Wl(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},ct=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var si=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Wn.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(R.min(),i,new q(k),Me(),C())}},Wn=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,C(),C(),C())}};var Lt=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},oi=class{constructor(e,n){this.targetId=e,this.fe=n}},ai=class{constructor(e,n,r=oe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},ci=class{constructor(){this.ge=0,this.pe=Hl(),this.ye=oe.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=C(),n=C(),r=C();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:w()}}),new Wn(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=Hl()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,V(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},Ho=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=Me(),this.Qe=Kl(),this.Ke=new q(k)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:w()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Fo(s))if(r===0){let o=new E(s.path);this.We(n,o,ye.newNoDocument(o,R.min()))}else V(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}Gl?.tt(function(l,h,f,m,S){var A,v,x,M,$,ee;let ve={localCacheCount:l,existenceFilterCount:h.count,databaseId:f.database,projectId:f.projectId},W=h.unchangedNames;return W&&(ve.bloomFilter={applied:S===0,hashCount:(A=W?.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(M=(x=(v=W?.bits)===null||v===void 0?void 0:v.bitmap)===null||x===void 0?void 0:x.length)!==null&&M!==void 0?M:0,padding:(ee=($=W?.bits)===null||$===void 0?void 0:$.padding)!==null&&ee!==void 0?ee:0,mightContain:Ne=>{var It;return(It=m?.mightContain(Ne))!==null&&It!==void 0&&It}}),ve}(o,e.fe,this.Le.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=He(r).toUint8Array()}catch(c){if(c instanceof ni)return Ft("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Ko(o,i,s)}catch(c){return Ft(c instanceof ct?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Fo(a.target)){let c=new E(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,ye.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=C();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new si(e,n,this.Ke,this.qe,r);return this.qe=Me(),this.Qe=Kl(),this.Ke=new q(k),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new ci,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new ie(k),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||I("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new ci),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function Kl(){return new q(E.comparator)}function Hl(){return new q(E.comparator)}var Tm=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Am=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Sm=(()=>({and:"AND",or:"OR"}))(),Qo=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function Yo(t,e){return t.useProto3Json||Si(e)?e:{value:e}}function ui(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kh(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Rm(t,e){return ui(t,e.toTimestamp())}function De(t){return V(!!t),R.fromTimestamp(function(n){let r=Ke(n);return new Z(r.seconds,r.nanos)}(t))}function sc(t,e){return function(r){return new F(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function Nh(t){let e=F.fromString(t);return V(Lh(e)),e}function Jo(t,e){return sc(t.databaseId,e.path)}function fo(t,e){let n=Nh(e);if(n.get(1)!==t.databaseId.projectId)throw new y(p.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new y(p.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new E(Oh(n))}function Xo(t,e){return sc(t.databaseId,e)}function bm(t){let e=Nh(t);return e.length===4?F.emptyPath():Oh(e)}function Zo(t){return new F(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Oh(t){return V(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ql(t,e,n){return{name:Jo(t,e),fields:n.value.mapValue.fields}}function Pm(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:w()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,l){return u.useProto3Json?(V(l===void 0||typeof l=="string"),oe.fromBase64String(l||"")):(V(l===void 0||l instanceof Uint8Array),oe.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let l=u.code===void 0?p.UNKNOWN:Dh(u.code);return new y(l,u.message||"")}(o);n=new ai(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=fo(t,r.document.name),s=De(r.document.updateTime),o=r.document.createTime?De(r.document.createTime):R.min(),a=new _e({mapValue:{fields:r.document.fields}}),c=ye.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Lt(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=fo(t,r.document),s=r.readTime?De(r.readTime):R.min(),o=ye.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Lt([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=fo(t,r.document),s=r.removedTargetIds||[];n=new Lt([],s,i,null)}else{if(!("filter"in e))return w();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new Wo(i,s),a=r.targetId;n=new oi(a,o)}}return n}function Cm(t,e){let n;if(e instanceof mt)n={update:Ql(t,e.key,e.value)};else if(e instanceof jn)n={delete:Jo(t,e.key)};else if(e instanceof Fe)n={update:Ql(t,e.key,e.data),updateMask:Fm(e.fieldMask)};else{if(!(e instanceof $o))return w();n={verify:Jo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof jt)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ft)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof pt)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Wt)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw w()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Rm(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:w()}(t,e.precondition)),n}function Dm(t,e){return t&&t.length>0?(V(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?De(i.updateTime):De(s);return o.isEqual(R.min())&&(o=De(s)),new qo(o,i.transformResults||[])}(n,e))):[]}function km(t,e){return{documents:[Xo(t,e.path)]}}function Nm(t,e){let n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Xo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xo(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);let i=function(c){if(c.length!==0)return Vh(Ie.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);let s=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:Nt(h.field),direction:Vm(h.dir)}}(u))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);let o=Yo(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function Om(t){let e=bm(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){V(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(h){let f=xh(h);return f instanceof Ie&&hh(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(S){return new zt(Ot(S.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,Si(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){let f=!!h.before,m=h.values||[];return new $t(m,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){let f=!h.before,m=h.values||[];return new $t(m,f)}(n.endAt)),sm(e,i,o,s,a,"F",c,u)}function xm(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return w()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function xh(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Ot(n.unaryFilter.field);return j.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ot(n.unaryFilter.field);return j.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ot(n.unaryFilter.field);return j.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Ot(n.unaryFilter.field);return j.create(o,"!=",{nullValue:"NULL_VALUE"});default:return w()}}(t):t.fieldFilter!==void 0?function(n){return j.create(Ot(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return w()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ie.create(n.compositeFilter.filters.map(r=>xh(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return w()}}(n.compositeFilter.op))}(t):w()}function Vm(t){return Tm[t]}function Lm(t){return Am[t]}function Mm(t){return Sm[t]}function Nt(t){return{fieldPath:t.canonicalString()}}function Ot(t){return ce.fromServerFormat(t.fieldPath)}function Vh(t){return t instanceof j?function(n){if(n.op==="=="){if(Vl(n.value))return{unaryFilter:{field:Nt(n.field),op:"IS_NAN"}};if(xl(n.value))return{unaryFilter:{field:Nt(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Vl(n.value))return{unaryFilter:{field:Nt(n.field),op:"IS_NOT_NAN"}};if(xl(n.value))return{unaryFilter:{field:Nt(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nt(n.field),op:Lm(n.op),value:n.value}}}(t):t instanceof Ie?function(n){let r=n.getFilters().map(i=>Vh(i));return r.length===1?r[0]:{compositeFilter:{op:Mm(n.op),filters:r}}}(t):w()}function Fm(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Lh(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Kn=class t{constructor(e,n,r,i,s=R.min(),o=R.min(),a=oe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var ea=class{constructor(e){this.ut=e}};function Um(t){let e=Om({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Bo(e,e.limit,"L"):e}var li=class{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(B(e.integerValue));else if("doubleValue"in e){let r=B(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),$n(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(He(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?ch(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):w()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){let r=e.fields||{};this.Tt(n,55);for(let i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){let r=e.values||[];this.Tt(n,50);for(let i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),E.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}};li.St=new li;var ta=class{constructor(){this.on=new na}addToCollectionParentIndex(e,n){return this.on.add(n),g.resolve()}getCollectionParents(e,n){return g.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return g.resolve()}deleteFieldIndex(e,n){return g.resolve()}deleteAllFieldIndexes(e){return g.resolve()}createTargetIndexes(e,n){return g.resolve()}getDocumentsMatchingTarget(e,n){return g.resolve(null)}getIndexType(e,n){return g.resolve(0)}getFieldIndexes(e,n){return g.resolve([])}getNextCollectionGroupToUpdate(e){return g.resolve(null)}getMinOffset(e,n){return g.resolve(lt.min())}getMinOffsetFromCollectionGroup(e,n){return g.resolve(lt.min())}updateCollectionGroup(e,n,r){return g.resolve()}updateIndexEntries(e,n){return g.resolve()}},na=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new ie(F.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ie(F.comparator)).toArray()}};var AI=new Uint8Array(0);var Se=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Se.DEFAULT_COLLECTION_PERCENTILE=10,Se.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Se.DEFAULT=new Se(41943040,Se.DEFAULT_COLLECTION_PERCENTILE,Se.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Se.DISABLED=new Se(-1,0,0);var Hn=class t{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new t(0)}static Nn(){return new t(-1)}};var ra=class{constructor(){this.changes=new Qe(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ye.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?g.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ia=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var sa=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&qn(r.mutation,i,Re.empty(),Z.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,C()).next(()=>r))}getLocalViewOfDocuments(e,n,r=C()){let i=at();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Mn();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=at();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,C()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Me(),o=Bn(),a=function(){return Bn()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof Fe)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),qn(l.mutation,u,l.mutation.getFieldMask(),Z.now())):o.set(u.key,Re.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var h;return a.set(u,new ia(l,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Bn(),i=new q((o,a)=>o-a),s=C();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||Re.empty();l=a.applyToLocalView(u,l),r.set(c,l);let h=(i.get(a.batchId)||C()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,h=Eh();l.forEach(f=>{if(!s.has(f)){let m=Ph(n.get(f),r.get(f));m!==null&&h.set(f,m),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return g.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return E.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):gh(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):g.resolve(at()),a=-1,c=s;return o.next(u=>g.forEach(u,(l,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(l)?g.resolve():this.remoteDocumentCache.getEntry(e,l).next(f=>{c=c.insert(l,f)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,C())).next(l=>({batchId:a,changes:vh(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new E(n)).next(r=>{let i=Mn();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Mn();return this.indexManager.getCollectionParents(e,s).next(a=>g.forEach(a,c=>{let u=function(h,f){return new dt(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,ye.newInvalidDocument(l)))});let a=Mn();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&qn(l.mutation,u,Re.empty(),Z.now()),bi(n,u)&&(a=a.insert(c,u))}),a})}};var oa=class{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return g.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:De(i.createTime)}}(n)),g.resolve()}getNamedQuery(e,n){return g.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:Um(i.bundledQuery),readTime:De(i.readTime)}}(n)),g.resolve()}};var aa=class{constructor(){this.overlays=new q(E.comparator),this.lr=new Map}getOverlay(e,n){return g.resolve(this.overlays.get(n))}getOverlays(e,n){let r=at();return g.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),g.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),g.resolve()}getOverlaysForCollection(e,n,r){let i=at(),s=n.length+1,o=new E(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return g.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new q((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=at(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=at(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return g.resolve(a)}lt(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new jo(n,r));let s=this.lr.get(n);s===void 0&&(s=C(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}};var Qn=class{constructor(){this.hr=new ie(G.Pr),this.Ir=new ie(G.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){let r=new G(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new G(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){let n=new E(new F([])),r=new G(n,e),i=new G(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){let n=new E(new F([])),r=new G(n,e),i=new G(n,e+1),s=C();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new G(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},G=class{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return E.comparator(e.key,n.key)||k(e.gr,n.gr)}static Tr(e,n){return k(e.gr,n.gr)||E.comparator(e.key,n.key)}};var ca=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new ie(G.Pr)}checkEmpty(e){return g.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new zo(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.yr=this.yr.add(new G(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return g.resolve(o)}lookupMutationBatch(e,n){return g.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.Sr(r),s=i<0?0:i;return g.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return g.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return g.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new G(n,0),i=new G(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{let a=this.wr(o.gr);s.push(a)}),g.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ie(k);return n.forEach(i=>{let s=new G(i,0),o=new G(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),g.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;E.isDocumentKey(s)||(s=s.child(""));let o=new G(new E(s),0),a=new ie(k);return this.yr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.gr)),!0)},o),g.resolve(this.br(a))}br(e){let n=[];return e.forEach(r=>{let i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){V(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return g.forEach(n.mutations,i=>{let s=new G(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){let r=new G(n,0),i=this.yr.firstAfterOrEqual(r);return g.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,g.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){let n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var ua=class{constructor(e){this.Cr=e,this.docs=function(){return new q(E.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return g.resolve(r?r.document.mutableCopy():ye.newInvalidDocument(n))}getEntries(e,n){let r=Me();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ye.newInvalidDocument(i))}),g.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Me(),o=n.path,a=new E(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Yp(Qp(l),r)<=0||(i.has(l.key)||bi(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return g.resolve(s)}getAllFromCollectionGroup(e,n,r,i){w()}vr(e,n){return g.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new la(this)}getSize(e){return g.resolve(this.size)}},la=class extends ra{constructor(e){super(),this._r=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),g.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}};var ha=class{constructor(e){this.persistence=e,this.Fr=new Qe(n=>rc(n),ic),this.lastRemoteSnapshotVersion=R.min(),this.highestTargetId=0,this.Mr=0,this.Or=new Qn,this.targetCount=0,this.Nr=Hn.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),g.resolve()}getLastRemoteSnapshotVersion(e){return g.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return g.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),g.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),g.resolve()}kn(e){this.Fr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Nr=new Hn(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,g.resolve()}updateTargetData(e,n){return this.kn(n),g.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,g.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),g.waitFor(s).next(()=>i)}getTargetCount(e){return g.resolve(this.targetCount)}getTargetData(e,n){let r=this.Fr.get(n)||null;return g.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),g.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),g.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),g.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Or.mr(n);return g.resolve(r)}containsKey(e,n){return g.resolve(this.Or.containsKey(n))}};var da=class{constructor(e,n){this.Br={},this.overlays={},this.Lr=new oh(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new ha(this),this.indexManager=new ta,this.remoteDocumentCache=function(i){return new ua(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new ea(n),this.Kr=new oa(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new aa,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new ca(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){I("MemoryPersistence","Starting transaction:",e);let i=new fa(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return g.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},fa=class extends So{constructor(e){super(),this.currentSequenceNumber=e}},pa=class t{constructor(e){this.persistence=e,this.Gr=new Qn,this.zr=null}static jr(e){return new t(e)}get Hr(){if(this.zr)return this.zr;throw w()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),g.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),g.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),g.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return g.forEach(this.Hr,r=>{let i=E.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,R.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return g.or([()=>g.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}};var ma=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=C(),i=C();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var ga=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var _a=class{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new ga;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(Ln()<=P.DEBUG&&I("QueryEngine","SDK will not create cache indexes for query:",kt(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),g.resolve()):(Ln()<=P.DEBUG&&I("QueryEngine","Query:",kt(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Ln()<=P.DEBUG&&I("QueryEngine","The SDK decides to create cache indexes for query:",kt(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ce(n))):g.resolve())}zi(e,n){if(Ul(n))return g.resolve(null);let r=Ce(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Bo(n,null,"F"),r=Ce(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=C(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Yi(n,a);return this.Zi(n,u,o,c.readTime)?this.zi(e,Bo(n,null,"F")):this.Xi(e,u,n,c)}))})))}ji(e,n,r,i){return Ul(n)||i.isEqual(R.min())?g.resolve(null):this.Gi.getDocuments(e,r).next(s=>{let o=this.Yi(n,s);return this.Zi(n,o,r,i)?g.resolve(null):(Ln()<=P.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),kt(n)),this.Xi(e,o,n,Hp(i,-1)).next(a=>a))})}Yi(e,n){let r=new ie(yh(e));return n.forEach((i,s)=>{bi(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return Ln()<=P.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",kt(n)),this.Gi.getDocumentsMatchingQuery(e,n,lt.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var ya=class{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new q(k),this.ns=new Qe(s=>rc(s),ic),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sa(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}};function Bm(t,e,n,r){return new ya(t,e,n,r)}function Mh(t,e){return d(this,null,function*(){let n=b(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=C();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({_s:u,removedBatchIds:o,addedBatchIds:a}))})})})}function qm(t,e){let n=b(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){let h=u.batch,f=h.keys(),m=g.resolve();return f.forEach(S=>{m=m.next(()=>l.getEntry(c,S)).next(A=>{let v=u.docVersions.get(S);V(v!==null),A.version.compareTo(v)<0&&(h.applyToRemoteDocument(A,u),A.isValidDocument()&&(A.setReadTime(u.commitVersion),l.addEntry(A)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=C();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Fh(t){let e=b(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function $m(t,e){let n=b(t),r=e.snapshotVersion,i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;let a=[];e.targetChanges.forEach((l,h)=>{let f=i.get(h);if(!f)return;a.push(n.qr.removeMatchingKeys(s,l.removedDocuments,h).next(()=>n.qr.addMatchingKeys(s,l.addedDocuments,h)));let m=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(oe.EMPTY_BYTE_STRING,R.min()).withLastLimboFreeSnapshotVersion(R.min()):l.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(l.resumeToken,r)),i=i.insert(h,m),function(A,v,x){return A.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(f,m,l)&&a.push(n.qr.updateTargetData(s,m))});let c=Me(),u=C();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(zm(s,o,e.documentUpdates).next(l=>{c=l.us,u=l.cs})),!r.isEqual(R.min())){let l=n.qr.getLastRemoteSnapshotVersion(s).next(h=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return g.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ts=i,s))}function zm(t,e,n){let r=C(),i=C();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Me();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(R.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):I("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{us:o,cs:i}})}function Gm(t,e){let n=b(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function jm(t,e){let n=b(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,g.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new Kn(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function Ia(t,e,n){return d(this,null,function*(){let r=b(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!tr(o))throw o;I("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)})}function Yl(t,e,n){let r=b(t),i=R.min(),s=C();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){let h=b(c),f=h.ns.get(l);return f!==void 0?g.resolve(h.ts.get(f)):h.qr.getTargetData(u,l)}(r,o,Ce(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:R.min(),n?s:C())).next(a=>(Wm(r,am(e),a),{documents:a,ls:s})))}function Wm(t,e,n){let r=t.rs.get(e)||R.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}var hi=class{constructor(){this.activeTargetIds=fm()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var va=class{constructor(){this.eo=new hi,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new hi,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Ea=class{ro(e){}shutdown(){}};var di=class{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){I("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ao)e(0)}_o(){I("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Qr=null;function po(){return Qr===null?Qr=function(){return 268435456+Math.round(2147483648*Math.random())}():Qr++,"0x"+Qr.toString(16)}var Km={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var wa=class{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}};var re="WebChannelConnection",Ta=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){let a=po(),c=this.So(n,r);I("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(u,s,o),this.Do(n,c,u,i).then(l=>(I("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Ft("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zt}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){let i=Km[n];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){let s=po();return new Promise((o,a)=>{let c=new Pl;c.setWithCredentials(!0),c.listenOnce(Rl.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Kr.NO_ERROR:let l=c.getResponseJson();I(re,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Kr.TIMEOUT:I(re,`RPC '${e}' ${s} timed out`),a(new y(p.DEADLINE_EXCEEDED,"Request time out"));break;case Kr.HTTP_ERROR:let h=c.getStatus();if(I(re,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);let m=f?.error;if(m&&m.status&&m.message){let S=function(v){let x=v.toLowerCase().replace(/_/g,"-");return Object.values(p).indexOf(x)>=0?x:p.UNKNOWN}(m.status);a(new y(S,m.message))}else a(new y(p.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new y(p.UNAVAILABLE,"Connection failed."));break;default:w()}}finally{I(re,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);I(re,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}vo(e,n,r){let i=po(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Al(),a=Sl(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.bo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");I(re,`Creating RPC '${e}' stream ${i}: ${l}`,c);let h=o.createWebChannel(l,c),f=!1,m=!1,S=new wa({co:v=>{m?I(re,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(f||(I(re,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),I(re,`RPC '${e}' stream ${i} sending:`,v),h.send(v))},lo:()=>h.close()}),A=(v,x,M)=>{v.listen(x,$=>{try{M($)}catch(ee){setTimeout(()=>{throw ee},0)}})};return A(h,Vn.EventType.OPEN,()=>{m||I(re,`RPC '${e}' stream ${i} transport opened.`)}),A(h,Vn.EventType.CLOSE,()=>{m||(m=!0,I(re,`RPC '${e}' stream ${i} transport closed`),S.Ro())}),A(h,Vn.EventType.ERROR,v=>{m||(m=!0,Ft(re,`RPC '${e}' stream ${i} transport errored:`,v),S.Ro(new y(p.UNAVAILABLE,"The operation could not be completed")))}),A(h,Vn.EventType.MESSAGE,v=>{var x;if(!m){let M=v.data[0];V(!!M);let $=M,ee=$.error||((x=$[0])===null||x===void 0?void 0:x.error);if(ee){I(re,`RPC '${e}' stream ${i} received error:`,ee);let ve=ee.status,W=function(nn){let ar=z[nn];if(ar!==void 0)return Dh(ar)}(ve),Ne=ee.message;W===void 0&&(W=p.INTERNAL,Ne="Unknown error status: "+ve+" with message "+ee.message),m=!0,S.Ro(new y(W,Ne)),h.close()}else I(re,`RPC '${e}' stream ${i} received:`,M),S.Vo(M)}}),A(a,bl.STAT_EVENT,v=>{v.stat===ho.PROXY?I(re,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===ho.NOPROXY&&I(re,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.Ao()},0),S}};function mo(){return typeof document<"u"?document:null}function Pi(t){return new Qo(t,!0)}var fi=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();let n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&I("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}};var pi=class{constructor(e,n,r,i,s,o,a,c){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new fi(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}stop(){return d(this,null,function*(){this.jo()&&(yield this.close(0))})}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){return d(this,null,function*(){if(this.Ho())return this.close(0)})}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,n){return d(this,null,function*(){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===p.RESOURCE_EXHAUSTED?(Le(n.toString()),Le("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===p.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Io(n)})}r_(){}auth(){this.state=1;let e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{let i=new y(p.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){let r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(()=>d(this,null,function*(){this.state=0,this.start()}))}o_(e){return I("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(I("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Aa=class extends pi{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();let n=Pm(this.serializer,e),r=function(s){if(!("targetChange"in s))return R.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?R.min():o.readTime?De(o.readTime):R.min()}(e);return this.listener.a_(n,r)}u_(e){let n={};n.database=Zo(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=Fo(c)?{documents:km(s,c)}:{query:Nm(s,c)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=kh(s,o.resumeToken);let u=Yo(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(R.min())>0){a.readTime=ui(s,o.snapshotVersion.toTimestamp());let u=Yo(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=xm(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){let n={};n.database=Zo(this.serializer),n.removeTarget=e,this.e_(n)}},Sa=class extends pi{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(V(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();let n=Dm(e.writeResults,e.commitTime),r=De(e.commitTime);return this.listener.I_(r,n)}return V(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){let e={};e.database=Zo(this.serializer),this.e_(e)}P_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Cm(this.serializer,r))};this.e_(n)}};var Ra=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new y(p.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===p.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new y(p.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===p.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new y(p.UNKNOWN,s.toString())})}terminate(){this.d_=!0}};var ba=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Le(n),this.f_=!1):I("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}};var Pa=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(o=>{r.enqueueAndForget(()=>d(this,null,function*(){gt(this)&&(I("RemoteStore","Restarting streams for network reachability change."),yield function(c){return d(this,null,function*(){let u=b(c);u.C_.add(4),yield nr(u),u.M_.set("Unknown"),u.C_.delete(4),yield Ci(u)})}(this))}))}),this.M_=new ba(r,i)}};function Ci(t){return d(this,null,function*(){if(gt(t))for(let e of t.v_)yield e(!0)})}function nr(t){return d(this,null,function*(){for(let e of t.v_)yield e(!1)})}function Uh(t,e){let n=b(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),cc(n)?ac(n):tn(n).Ho()&&oc(n,e))}function Bh(t,e){let n=b(t),r=tn(n);n.D_.delete(e),r.Ho()&&qh(n,e),n.D_.size===0&&(r.Ho()?r.Zo():gt(n)&&n.M_.set("Unknown"))}function oc(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(R.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}tn(t).u_(e)}function qh(t,e){t.x_.Oe(e),tn(t).c_(e)}function ac(t){t.x_=new Ho({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),tn(t).start(),t.M_.g_()}function cc(t){return gt(t)&&!tn(t).jo()&&t.D_.size>0}function gt(t){return b(t).C_.size===0}function $h(t){t.x_=void 0}function Hm(t){return d(this,null,function*(){t.D_.forEach((e,n)=>{oc(t,e)})})}function Qm(t,e){return d(this,null,function*(){$h(t),cc(t)?(t.M_.w_(e),ac(t)):t.M_.set("Unknown")})}function Ym(t,e,n){return d(this,null,function*(){if(t.M_.set("Online"),e instanceof ai&&e.state===2&&e.cause)try{yield function(i,s){return d(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.D_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.D_.delete(a),i.x_.removeTarget(a))})}(t,e)}catch(r){I("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield mi(t,r)}else if(e instanceof Lt?t.x_.$e(e):e instanceof oi?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(R.min()))try{let r=yield Fh(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.x_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let l=s.D_.get(u);l&&s.D_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let l=s.D_.get(c);if(!l)return;s.D_.set(c,l.withResumeToken(oe.EMPTY_BYTE_STRING,l.snapshotVersion)),qh(s,c);let h=new Kn(l.target,c,u,l.sequenceNumber);oc(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){I("RemoteStore","Failed to raise snapshot:",r),yield mi(t,r)}})}function mi(t,e,n){return d(this,null,function*(){if(!tr(e))throw e;t.C_.add(1),yield nr(t),t.M_.set("Offline"),n||(n=()=>Fh(t.localStore)),t.asyncQueue.enqueueRetryable(()=>d(this,null,function*(){I("RemoteStore","Retrying IndexedDB access"),yield n(),t.C_.delete(1),yield Ci(t)}))})}function zh(t,e){return e().catch(n=>mi(t,n,e))}function Di(t){return d(this,null,function*(){let e=b(t),n=Ye(e),r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;Jm(e);)try{let i=yield Gm(e.localStore,r);if(i===null){e.b_.length===0&&n.Zo();break}r=i.batchId,Xm(e,i)}catch(i){yield mi(e,i)}Gh(e)&&jh(e)})}function Jm(t){return gt(t)&&t.b_.length<10}function Xm(t,e){t.b_.push(e);let n=Ye(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function Gh(t){return gt(t)&&!Ye(t).jo()&&t.b_.length>0}function jh(t){Ye(t).start()}function Zm(t){return d(this,null,function*(){Ye(t).E_()})}function eg(t){return d(this,null,function*(){let e=Ye(t);for(let n of t.b_)e.P_(n.mutations)})}function tg(t,e,n){return d(this,null,function*(){let r=t.b_.shift(),i=Go.from(r,e,n);yield zh(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Di(t)})}function ng(t,e){return d(this,null,function*(){e&&Ye(t).h_&&(yield function(r,i){return d(this,null,function*(){if(function(o){return vm(o)&&o!==p.ABORTED}(i.code)){let s=r.b_.shift();Ye(r).Yo(),yield zh(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Di(r)}})}(t,e)),Gh(t)&&jh(t)})}function Jl(t,e){return d(this,null,function*(){let n=b(t);n.asyncQueue.verifyOperationInProgress(),I("RemoteStore","RemoteStore received new credentials");let r=gt(n);n.C_.add(3),yield nr(n),r&&n.M_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),yield Ci(n)})}function rg(t,e){return d(this,null,function*(){let n=b(t);e?(n.C_.delete(2),yield Ci(n)):e||(n.C_.add(2),yield nr(n),n.M_.set("Unknown"))})}function tn(t){return t.O_||(t.O_=function(n,r,i){let s=b(n);return s.A_(),new Aa(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Hm.bind(null,t),Io:Qm.bind(null,t),a_:Ym.bind(null,t)}),t.v_.push(e=>d(this,null,function*(){e?(t.O_.Yo(),cc(t)?ac(t):t.M_.set("Unknown")):(yield t.O_.stop(),$h(t))}))),t.O_}function Ye(t){return t.N_||(t.N_=function(n,r,i){let s=b(n);return s.A_(),new Sa(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Zm.bind(null,t),Io:ng.bind(null,t),T_:eg.bind(null,t),I_:tg.bind(null,t)}),t.v_.push(e=>d(this,null,function*(){e?(t.N_.Yo(),yield Di(t)):(yield t.N_.stop(),t.b_.length>0&&(I("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))}))),t.N_}var Ca=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new be,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new y(p.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function uc(t,e){if(Le("AsyncQueue",`${e}: ${t}`),tr(t))return new y(p.UNAVAILABLE,`${e}: ${t}`);throw t}var gi=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||E.comparator(n.key,r.key):(n,r)=>E.comparator(n.key,r.key),this.keyedMap=Mn(),this.sortedSet=new q(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var _i=class{constructor(){this.B_=new q(E.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):w():this.B_=this.B_.insert(n,e)}L_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},Ht=class t{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,gi.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ri(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var Da=class{constructor(){this.k_=void 0,this.listeners=[]}},ka=class{constructor(){this.queries=new Qe(e=>_h(e),Ri),this.onlineState="Unknown",this.q_=new Set}};function ig(t,e){return d(this,null,function*(){let n=b(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Da),i)try{s.k_=yield n.onListen(r)}catch(o){let a=uc(o,`Initialization of query '${kt(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&lc(n)})}function sg(t,e){return d(this,null,function*(){let n=b(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function og(t,e){let n=b(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&lc(n)}function ag(t,e,n){let r=b(t),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(n);r.queries.delete(e)}function lc(t){t.q_.forEach(e=>{e.next()})}var Na=class{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ht(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;let n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=Ht.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}};var yi=class{constructor(e){this.key=e}},Ii=class{constructor(e){this.key=e}},Oa=class{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=C(),this.mutatedKeys=C(),this._a=yh(e),this.aa=new gi(this._a)}get ua(){return this.ia}ca(e,n){let r=n?n.la:new _i,i=n?n.aa:this.aa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,h)=>{let f=i.get(l),m=bi(this.query,h)?h:null,S=!!f&&this.mutatedKeys.has(f.key),A=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations),v=!1;f&&m?f.data.isEqual(m.data)?S!==A&&(r.track({type:3,doc:m}),v=!0):this.ha(f,m)||(r.track({type:2,doc:m}),v=!0,(c&&this._a(m,c)>0||u&&this._a(m,u)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),v=!0):f&&!m&&(r.track({type:1,doc:f}),v=!0,(c||u)&&(a=!0)),v&&(m?(o=o.add(m),s=A?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;let o=e.la.L_();o.sort((l,h)=>function(m,S){let A=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return w()}};return A(m)-A(S)}(l.type,h.type)||this._a(l.doc,h.doc)),this.Pa(r),i=i!=null&&i;let a=n&&!i?this.Ia():[],c=this.oa.size===0&&this.current&&!i?1:0,u=c!==this.sa;return this.sa=c,o.length!==0||u?{snapshot:new Ht(this.query,e.aa,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new _i,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];let e=this.oa;this.oa=C(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});let n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new Ii(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new yi(r))}),n}da(e){this.ia=e.ls,this.oa=C();let n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return Ht.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}},xa=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},Va=class{constructor(e){this.key=e,this.Ra=!1}},La=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Qe(a=>_h(a),Ri),this.fa=new Map,this.ga=new Set,this.pa=new q(E.comparator),this.ya=new Map,this.wa=new Qn,this.Sa={},this.ba=new Map,this.Da=Hn.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}};function cg(t,e){return d(this,null,function*(){let n=yg(t),r,i,s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{let o=yield jm(n.localStore,Ce(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield ug(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Uh(n.remoteStore,o)}return i})}function ug(t,e,n,r,i){return d(this,null,function*(){t.va=(h,f,m)=>function(A,v,x,M){return d(this,null,function*(){let $=v.view.ca(x);$.Zi&&($=yield Yl(A.localStore,v.query,!1).then(({documents:Ne})=>v.view.ca(Ne,$)));let ee=M&&M.targetChanges.get(v.targetId),ve=M&&M.targetMismatches.get(v.targetId)!=null,W=v.view.applyChanges($,A.isPrimaryClient,ee,ve);return Zl(A,v.targetId,W.Ta),W.snapshot})}(t,h,f,m);let s=yield Yl(t.localStore,e,!0),o=new Oa(e,s.ls),a=o.ca(s.documents),c=Wn.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);Zl(t,n,u.Ta);let l=new xa(e,n,o);return t.ma.set(e,l),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),u.snapshot})}function lg(t,e){return d(this,null,function*(){let n=b(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!Ri(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Ia(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Bh(n.remoteStore,r.targetId),Ma(n,r.targetId)}).catch(er))):(Ma(n,r.targetId),yield Ia(n.localStore,r.targetId,!0))})}function hg(t,e,n){return d(this,null,function*(){let r=Ig(t);try{let i=yield function(o,a){let c=b(o),u=Z.now(),l=a.reduce((m,S)=>m.add(S.key),C()),h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let S=Me(),A=C();return c.ss.getEntries(m,l).next(v=>{S=v,S.forEach((x,M)=>{M.isValidDocument()||(A=A.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,S)).next(v=>{h=v;let x=[];for(let M of a){let $=Im(M,h.get(M.key).overlayedDocument);$!=null&&x.push(new Fe(M.key,$,uh($.value.mapValue),je.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,x,a)}).next(v=>{f=v;let x=v.applyToLocalDocumentSet(h,A);return c.documentOverlayCache.saveOverlays(m,v.batchId,x)})}).then(()=>({batchId:f.batchId,changes:vh(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Sa[o.currentUser.toKey()];u||(u=new q(k)),u=u.insert(a,c),o.Sa[o.currentUser.toKey()]=u}(r,i.batchId,n),yield rr(r,i.changes),yield Di(r.remoteStore)}catch(i){let s=uc(i,"Failed to persist write");n.reject(s)}})}function Wh(t,e){return d(this,null,function*(){let n=b(t);try{let r=yield $m(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.ya.get(s);o&&(V(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?V(o.Ra):i.removedDocuments.size>0&&(V(o.Ra),o.Ra=!1))}),yield rr(n,r,e)}catch(r){yield er(r)}})}function Xl(t,e,n){let r=b(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ma.forEach((s,o)=>{let a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=b(o);c.onlineState=a;let u=!1;c.queries.forEach((l,h)=>{for(let f of h.listeners)f.Q_(a)&&(u=!0)}),u&&lc(c)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function dg(t,e,n){return d(this,null,function*(){let r=b(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.ya.get(e),s=i&&i.key;if(s){let o=new q(E.comparator);o=o.insert(s,ye.newNoDocument(s,R.min()));let a=C().add(s),c=new si(R.min(),new Map,new q(k),o,a);yield Wh(r,c),r.pa=r.pa.remove(s),r.ya.delete(e),hc(r)}else yield Ia(r.localStore,e,!1).then(()=>Ma(r,e,n)).catch(er)})}function fg(t,e){return d(this,null,function*(){let n=b(t),r=e.batch.batchId;try{let i=yield qm(n.localStore,e);Hh(n,r,null),Kh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield rr(n,i)}catch(i){yield er(i)}})}function pg(t,e,n){return d(this,null,function*(){let r=b(t);try{let i=yield function(o,a){let c=b(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(h=>(V(h!==null),l=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,e);Hh(r,e,n),Kh(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield rr(r,i)}catch(i){yield er(i)}})}function Kh(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function Hh(t,e,n){let r=b(t),i=r.Sa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Ma(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||Qh(t,r)})}function Qh(t,e){t.ga.delete(e.path.canonicalString());let n=t.pa.get(e);n!==null&&(Bh(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),hc(t))}function Zl(t,e,n){for(let r of n)r instanceof yi?(t.wa.addReference(r.key,e),mg(t,r)):r instanceof Ii?(I("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||Qh(t,r.key)):w()}function mg(t,e){let n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(I("SyncEngine","New document in limbo: "+n),t.ga.add(r),hc(t))}function hc(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){let e=t.ga.values().next().value;t.ga.delete(e);let n=new E(F.fromString(e)),r=t.Da.next();t.ya.set(r,new Va(n)),t.pa=t.pa.insert(n,r),Uh(t.remoteStore,new Kn(Ce(mh(n.path)),r,"TargetPurposeLimboResolution",oh._e))}}function rr(t,e,n){return d(this,null,function*(){let r=b(t),i=[],s=[],o=[];r.ma.isEmpty()||(r.ma.forEach((a,c)=>{o.push(r.va(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=ma.Qi(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.Va.a_(i),yield function(c,u){return d(this,null,function*(){let l=b(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>g.forEach(u,f=>g.forEach(f.ki,m=>l.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>g.forEach(f.qi,m=>l.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!tr(h))throw h;I("LocalStore","Failed to update sequence numbers: "+h)}for(let h of u){let f=h.targetId;if(!h.fromCache){let m=l.ts.get(f),S=m.snapshotVersion,A=m.withLastLimboFreeSnapshotVersion(S);l.ts=l.ts.insert(f,A)}}})}(r.localStore,s))})}function gg(t,e){return d(this,null,function*(){let n=b(t);if(!n.currentUser.isEqual(e)){I("SyncEngine","User change. New user:",e.toKey());let r=yield Mh(n.localStore,e);n.currentUser=e,function(s,o){s.ba.forEach(a=>{a.forEach(c=>{c.reject(new y(p.CANCELLED,o))})}),s.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield rr(n,r._s)}})}function _g(t,e){let n=b(t),r=n.ya.get(e);if(r&&r.Ra)return C().add(r.key);{let i=C(),s=n.fa.get(e);if(!s)return i;for(let o of s){let a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function yg(t){let e=b(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Wh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=_g.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dg.bind(null,e),e.Va.a_=og.bind(null,e.eventManager),e.Va.Fa=ag.bind(null,e.eventManager),e}function Ig(t){let e=b(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fg.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pg.bind(null,e),e}var vi=class{constructor(){this.synchronizeTabs=!1}initialize(e){return d(this,null,function*(){this.serializer=Pi(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Bm(this.persistence,new _a,e.initialUser,this.serializer)}createPersistence(e){return new da(pa.jr,this.serializer)}createSharedClientState(e){return new va}terminate(){return d(this,null,function*(){this.gcScheduler&&this.gcScheduler.stop(),yield this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Fa=class{initialize(e,n){return d(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Xl(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=gg.bind(null,this.syncEngine),yield rg(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new ka}()}createDatastore(e){let n=Pi(e.databaseInfo.databaseId),r=function(s){return new Ta(s)}(e.databaseInfo);return function(s,o,a,c){return new Ra(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Pa(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Xl(this.syncEngine,n,0),function(){return di.D()?new di:new Ea}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,l){let h=new La(i,s,o,a,c,u);return l&&(h.Ca=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return function(n){return d(this,null,function*(){let r=b(n);I("RemoteStore","RemoteStore shutting down."),r.C_.add(5),yield nr(r),r.F_.shutdown(),r.M_.set("Unknown")})}(this.remoteStore)}};var Ua=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Le("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var Ba=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Y.UNAUTHENTICATED,this.clientId=Zr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>d(this,null,function*(){I("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(I("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}getConfiguration(){return d(this,null,function*(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}})}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new y(p.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new be;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>d(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=uc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function go(t,e){return d(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),I("FirestoreClient","Initializing OfflineComponentProvider");let n=yield t.getConfiguration();yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>d(this,null,function*(){r.isEqual(i)||(yield Mh(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function eh(t,e){return d(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield Eg(t);I("FirestoreClient","Initializing OnlineComponentProvider");let r=yield t.getConfiguration();yield e.initialize(n,r),t.setCredentialChangeListener(i=>Jl(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>Jl(e.remoteStore,s)),t._onlineComponents=e})}function vg(t){return t.name==="FirebaseError"?t.code===p.FAILED_PRECONDITION||t.code===p.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function Eg(t){return d(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){I("FirestoreClient","Using user provided OfflineComponentProvider");try{yield go(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!vg(n))throw n;Ft("Error using user provided cache. Falling back to memory cache: "+n),yield go(t,new vi)}}else I("FirestoreClient","Using default OfflineComponentProvider"),yield go(t,new vi);return t._offlineComponents})}function Yh(t){return d(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(I("FirestoreClient","Using user provided OnlineComponentProvider"),yield eh(t,t._uninitializedComponentsProvider._online)):(I("FirestoreClient","Using default OnlineComponentProvider"),yield eh(t,new Fa))),t._onlineComponents})}function wg(t){return Yh(t).then(e=>e.syncEngine)}function Tg(t){return d(this,null,function*(){let e=yield Yh(t),n=e.eventManager;return n.onListen=cg.bind(null,e.syncEngine),n.onUnlisten=lg.bind(null,e.syncEngine),n})}function Ag(t,e,n={}){let r=new be;return t.asyncQueue.enqueueAndForget(()=>d(this,null,function*(){return function(s,o,a,c,u){let l=new Ua({next:f=>{o.enqueueAndForget(()=>sg(s,h)),f.fromCache&&c.source==="server"?u.reject(new y(p.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new Na(a,l,{includeMetadataChanges:!0,J_:!0});return ig(s,h)}(yield Tg(t),t.asyncQueue,e,n,r)})),r.promise}function Jh(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var th=new Map;function Xh(t,e,n){if(!n)throw new y(p.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Sg(t,e,n,r){if(e===!0&&r===!0)throw new y(p.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nh(t){if(!E.isDocumentKey(t))throw new y(p.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rh(t){if(E.isDocumentKey(t))throw new y(p.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ki(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":w()}function Qt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new y(p.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=ki(t);throw new y(p.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}var Ei=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new y(p.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new y(p.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Sg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Jh((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new y(p.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new y(p.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new y(p.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Yt=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ei({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new y(p.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new y(p.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ei(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new _o;switch(r.type){case"firstParty":return new Eo(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new y(p.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=th.get(n);r&&(I("ComponentProvider","Removing Datastore"),th.delete(n),r.terminate())}(this),Promise.resolve()}};function Zh(t,e,n,r={}){var i;let s=(t=Qt(t,Yt))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ft("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Y.MOCK_USER;else{a=zc(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new y(p.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Y(u)}t._authCredentials=new yo(new Xr(a,c))}}var Jt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},ue=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new We(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},We=class t extends Jt{constructor(e,n,r){super(e,n,mh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ue(this.firestore,null,new E(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function Rg(t,e,...n){if(t=de(t),Xh("collection","path",e),t instanceof Yt){let r=F.fromString(e,...n);return rh(r),new We(t,null,r)}{if(!(t instanceof ue||t instanceof We))throw new y(p.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(F.fromString(e,...n));return rh(r),new We(t.firestore,null,r)}}function bg(t,e,...n){if(t=de(t),arguments.length===1&&(e=Zr.newId()),Xh("doc","path",e),t instanceof Yt){let r=F.fromString(e,...n);return nh(r),new ue(t,null,new E(r))}{if(!(t instanceof ue||t instanceof We))throw new y(p.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(F.fromString(e,...n));return nh(r),new ue(t.firestore,t instanceof We?t.converter:null,new E(r))}}var qa=class{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new fi(this,"async_queue_retry"),this.iu=()=>{let n=mo();n&&I("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};let e=mo();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;let n=mo();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});let n=new be;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){return d(this,null,function*(){if(this.Ya.length!==0){try{yield this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!tr(e))throw e;I("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}})}ou(e){let n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Le("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);let i=Ca.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&w()}verifyOperationInProgress(){}uu(){return d(this,null,function*(){let e;do e=this.Ja,yield e;while(e!==this.Ja)})}cu(e){for(let n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){let n=this.Xa.indexOf(e);this.Xa.splice(n,1)}};var Xt=class extends Yt{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new qa}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||nd(this),this._firestoreClient.terminate()}};function ed(t,e){let n=typeof t=="object"?t:an(),r=typeof t=="string"?t:e||"(default)",i=_s(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=qc("firestore");s&&Zh(i,...s)}return i}function td(t){return t._firestoreClient||nd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function nd(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,l){return new Ro(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Jh(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new Ba(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Yn=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(oe.fromBase64String(e))}catch(n){throw new y(p.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(oe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Jn=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new y(p.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ce(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var wi=class{constructor(e){this._methodName=e}};var Xn=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new y(p.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new y(p.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return k(this._lat,e._lat)||k(this._long,e._long)}};var Pg=/^__.*__$/,$a=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Fe(e,this.data,this.fieldMask,n,this.fieldTransforms):new mt(e,this.data,n,this.fieldTransforms)}};function rd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw w()}}var za=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return Ti(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(rd(this.Iu)&&Pg.test(e))throw this.mu('Document fields cannot begin and end with "__"')}},Ga=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Pi(e)}pu(e,n,r,i=!1){return new za({Iu:e,methodName:n,gu:r,path:ce.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function id(t){let e=t._freezeSettings(),n=Pi(t._databaseId);return new Ga(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Cg(t,e,n,r,i,s={}){let o=t.pu(s.merge||s.mergeFields?2:0,e,n,i);ad("Data must be an object, but it was:",o,r);let a=sd(r,o),c,u;if(s.merge)c=new Re(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let h of s.mergeFields){let f=kg(e,h,n);if(!o.contains(f))throw new y(p.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Og(l,f)||l.push(f)}c=new Re(l),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new $a(new _e(a),c,u)}function Dg(t,e,n,r=!1){return dc(n,t.pu(r?4:3,e))}function dc(t,e){if(od(t=de(t)))return ad("Unsupported field value:",e,t),sd(t,e);if(t instanceof wi)return function(r,i){if(!rd(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=dc(a,i.Vu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=de(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pm(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Z.fromDate(r);return{timestampValue:ui(i.serializer,s)}}if(r instanceof Z){let s=new Z(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ui(i.serializer,s)}}if(r instanceof Xn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Yn)return{bytesValue:kh(i.serializer,r._byteString)};if(r instanceof ue){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:sc(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${ki(r)}`)}(t,e)}function sd(t,e){let n={};return ah(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):en(t,(r,i)=>{let s=dc(i,e.Eu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function od(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Z||t instanceof Xn||t instanceof Yn||t instanceof ue||t instanceof wi)}function ad(t,e,n){if(!od(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=ki(n);throw r==="an object"?e.mu(t+" a custom object"):e.mu(t+" "+r)}}function kg(t,e,n){if((e=de(e))instanceof Jn)return e._internalPath;if(typeof e=="string")return cd(t,e);throw Ti("Field path arguments must be of type string or ",t,!1,void 0,n)}var Ng=new RegExp("[~\\*/\\[\\]]");function cd(t,e,n){if(e.search(Ng)>=0)throw Ti(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Jn(...e.split("."))._internalPath}catch{throw Ti(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ti(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new y(p.INVALID_ARGUMENT,a+t+c)}function Og(t,e){return t.some(n=>n.isEqual(e))}var Ai=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ue(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new ja(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(ud("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},ja=class extends Ai{data(){return super.data()}};function ud(t,e){return typeof e=="string"?cd(t,e):e instanceof Jn?e._internalPath:e._delegate._internalPath}function xg(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new y(p.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zn=class{},Wa=class extends Zn{};function Vg(t,e,...n){let r=[];e instanceof Zn&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof Ha).length,a=s.filter(c=>c instanceof Ka).length;if(o>1||o>0&&a>0)throw new y(p.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Ka=class t extends Wa{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return ld(e._query,n),new Jt(e.firestore,e.converter,Uo(e._query,n))}_parse(e){let n=id(e.firestore);return function(s,o,a,c,u,l,h){let f;if(u.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new y(p.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){sh(h,l);let m=[];for(let S of h)m.push(ih(c,s,S));f={arrayValue:{values:m}}}else f=ih(c,s,h)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||sh(h,l),f=Dg(a,o,h,l==="in"||l==="not-in");return j.create(u,l,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};var Ha=class t extends Zn{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ie.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)ld(o,c),o=Uo(o,c)}(e._query,n),new Jt(e.firestore,e.converter,Uo(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function ih(t,e,n){if(typeof(n=de(n))=="string"){if(n==="")throw new y(p.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gh(e)&&n.indexOf("/")!==-1)throw new y(p.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(F.fromString(n));if(!E.isDocumentKey(r))throw new y(p.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ol(t,new E(r))}if(n instanceof ue)return Ol(t,n._key);throw new y(p.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ki(n)}.`)}function sh(t,e){if(!Array.isArray(t)||t.length===0)throw new y(p.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ld(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new y(p.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new y(p.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Qa=class{convertValue(e,n="none"){switch(ht(e)){case 0:return null;case 1:return e.booleanValue;case 2:return B(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(He(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw w()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return en(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Xn(B(e.latitude),B(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=tc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(zn(e));default:return null}}convertTimestamp(e){let n=Ke(e);return new Z(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=F.fromString(e);V(Lh(r));let i=new ri(r.get(1),r.get(3)),s=new E(r.popFirst(5));return i.isEqual(n)||Le(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Lg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var Vt=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ya=class extends Ai{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Mt(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(ud("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Mt=class extends Ya{data(e={}){return super.data(e)}},Ja=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Vt(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Mt(this._firestore,this._userDataWriter,r.key,r,new Vt(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new y(p.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Mt(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Vt(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Mt(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Vt(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:Mg(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function Mg(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return w()}}var Xa=class extends Qa{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yn(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new ue(this.firestore,null,n)}};function Fg(t){t=Qt(t,Jt);let e=Qt(t.firestore,Xt),n=td(e),r=new Xa(e);return xg(t._query),Ag(n,t._query).then(i=>new Ja(e,r,t,i))}function Ug(t,e,n){t=Qt(t,ue);let r=Qt(t.firestore,Xt),i=Lg(t.converter,e,n);return hd(r,[Cg(id(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,je.none())])}function Bg(t){return hd(Qt(t.firestore,Xt),[new jn(t._key,je.none())])}function hd(t,e){return function(r,i){let s=new be;return r.asyncQueue.enqueueAndForget(()=>d(this,null,function*(){return hg(yield wg(r),i,s)})),s.promise}(td(t),e)}(function(e,n=!0){(function(i){Zt=i})(wt),$e(new fe("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Xt(new Io(r.getProvider("auth-internal")),new To(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new y(p.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ri(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),K(Dl,"4.4.0",e),K(Dl,"4.4.0","esm2017")})();function yd(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Id=yd,vd=new Oe("auth","Firebase",yd());var xi=new Be("@firebase/auth");function qg(t,...e){xi.logLevel<=P.WARN&&xi.warn(`Auth (${wt}): ${t}`,...e)}function Oi(t,...e){xi.logLevel<=P.ERROR&&xi.error(`Auth (${wt}): ${t}`,...e)}function dd(t,...e){throw Tc(t,...e)}function Ed(t,...e){return Tc(t,...e)}function $g(t,e,n){let r=Object.assign(Object.assign({},Id()),{[e]:n});return new Oe("auth","Firebase",r).create(e,{appName:t.name})}function Tc(t,...e){if(typeof t!="string"){let n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return vd.create(t,...e)}function O(t,e,...n){if(!t)throw Tc(e,...n)}function ir(t){let e="INTERNAL ASSERTION FAILED: "+t;throw Oi(e),new Error(e)}function Vi(t,e){t||ir(e)}function zg(){return fd()==="http:"||fd()==="https:"}function fd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function Gg(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zg()||jc()||"connection"in navigator)?navigator.onLine:!0}function jg(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var yt=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,Vi(n>e,"Short delay should be less than long delay!"),this.isMobile=Gc()||Wc()}get(){return Gg()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Wg(t,e){Vi(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var Li=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ir("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ir("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ir("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Kg={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Hg=new yt(3e4,6e4);function wd(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function zi(s,o,a,c){return d(this,arguments,function*(t,e,n,r,i={}){return Td(t,i,()=>d(this,null,function*(){let u={},l={};r&&(e==="GET"?l=r:u={body:JSON.stringify(r)});let h=ns(Object.assign({key:t.config.apiKey},l)).slice(1),f=yield t._getAdditionalHeaders();return f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode),Li.fetch()(Ad(t,t.config.apiHost,n,h),Object.assign({method:e,headers:f,referrerPolicy:"no-referrer"},u))}))})}function Td(t,e,n){return d(this,null,function*(){t._canInitEmulator=!1;let r=Object.assign(Object.assign({},Kg),e);try{let i=new mc(t),s=yield Promise.race([n(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Ni(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ni(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Ni(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Ni(t,"user-disabled",o);let l=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw $g(t,l,u);dd(t,l)}}catch(i){if(i instanceof le)throw i;dd(t,"network-request-failed",{message:String(i)})}})}function Ad(t,e,n,r){let i=`${e}${n}?${r}`;return t.config.emulator?Wg(t.config,i):`${t.config.apiScheme}://${i}`}var mc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ed(this.auth,"network-request-failed")),Hg.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Ni(t,e,n){let r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=Ed(t,e,r);return i.customData._tokenResponse=n,i}function Qg(t,e){return d(this,null,function*(){return zi(t,"POST","/v1/accounts:delete",e)})}function Yg(t,e){return d(this,null,function*(){return zi(t,"POST","/v1/accounts:lookup",e)})}function sr(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Ac(t,e=!1){return d(this,null,function*(){let n=de(t),r=yield n.getIdToken(e),i=Sd(r);O(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:sr(fc(i.auth_time)),issuedAtTime:sr(fc(i.iat)),expirationTime:sr(fc(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function fc(t){return Number(t)*1e3}function Sd(t){let[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Oi("JWT malformed, contained fewer than 3 sections"),null;try{let i=Xi(n);return i?JSON.parse(i):(Oi("Failed to decode base64 JWT payload"),null)}catch(i){return Oi("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Jg(t){let e=Sd(t);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function gc(t,e,n=!1){return d(this,null,function*(){if(n)return e;try{return yield e}catch(r){throw r instanceof le&&Xg(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})}function Xg({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var _c=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>d(this,null,function*(){yield this.iteration()}),n)}iteration(){return d(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Mi=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=sr(this.lastLoginAt),this.creationTime=sr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Fi(t){return d(this,null,function*(){var e;let n=t.auth,r=yield t.getIdToken(),i=yield gc(t,Yg(n,{idToken:r}));O(i?.users.length,n,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?e_(s.providerUserInfo):[],a=Zg(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!a?.length,l=c?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Mi(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(t,h)})}function Sc(t){return d(this,null,function*(){let e=de(t);yield Fi(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Zg(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function e_(t){return t.map(e=>{var{providerId:n}=e,r=Wi(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function t_(t,e){return d(this,null,function*(){let n=yield Td(t,{},()=>d(this,null,function*(){let r=ns({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=Ad(t,i,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Li.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function n_(t,e){return d(this,null,function*(){return zi(t,"POST","/v2/accounts:revokeToken",wd(t,e))})}var Ui=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}getToken(e,n=!1){return d(this,null,function*(){return O(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return d(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield t_(e,n);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){let{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new t;return r&&(O(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(O(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return ir("not implemented")}};function Je(t,e){O(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var Bi=class t{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Wi(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _c(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Mi(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return d(this,null,function*(){let n=yield gc(this,this.stsTokenManager.getToken(this.auth,e));return O(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return Ac(this,e)}reload(){return Sc(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return d(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&(yield Fi(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return d(this,null,function*(){let e=yield this.getIdToken();return yield gc(this,Qg(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,c,u,l;let h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(i=n.email)!==null&&i!==void 0?i:void 0,m=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=n.photoURL)!==null&&o!==void 0?o:void 0,A=(a=n.tenantId)!==null&&a!==void 0?a:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,x=(u=n.createdAt)!==null&&u!==void 0?u:void 0,M=(l=n.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:$,emailVerified:ee,isAnonymous:ve,providerData:W,stsTokenManager:Ne}=n;O($&&Ne,e,"internal-error");let It=Ui.fromJSON(this.name,Ne);O(typeof $=="string",e,"internal-error"),Je(h,e.name),Je(f,e.name),O(typeof ee=="boolean",e,"internal-error"),O(typeof ve=="boolean",e,"internal-error"),Je(m,e.name),Je(S,e.name),Je(A,e.name),Je(v,e.name),Je(x,e.name),Je(M,e.name);let nn=new t({uid:$,auth:e,email:f,emailVerified:ee,displayName:h,isAnonymous:ve,photoURL:S,phoneNumber:m,tenantId:A,stsTokenManager:It,createdAt:x,lastLoginAt:M});return W&&Array.isArray(W)&&(nn.providerData=W.map(ar=>Object.assign({},ar))),v&&(nn._redirectEventId=v),nn}static _fromIdTokenResponse(e,n,r=!1){return d(this,null,function*(){let i=new Ui;i.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Fi(s),s})}};var pd=new Map;function _t(t){Vi(t instanceof Function,"Expected a class definition");let e=pd.get(t);return e?(Vi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,pd.set(t,e),e)}var r_=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return d(this,null,function*(){return!0})}_set(n,r){return d(this,null,function*(){this.storage[n]=r})}_get(n){return d(this,null,function*(){let r=this.storage[n];return r===void 0?null:r})}_remove(n){return d(this,null,function*(){delete this.storage[n]})}_addListener(n,r){}_removeListener(n,r){}}return t.type="NONE",t})(),yc=r_;function pc(t,e,n){return`firebase:${t}:${e}:${n}`}var qi=class t{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=pc(this.userKey,i.apiKey,s),this.fullPersistenceKey=pc("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return d(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Bi._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return d(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,r="authUser"){return d(this,null,function*(){if(!n.length)return new t(_t(yc),e,r);let i=(yield Promise.all(n.map(u=>d(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=i[0]||_t(yc),o=pc(r,e.config.apiKey,e.name),a=null;for(let u of n)try{let l=yield u._get(o);if(l){let h=Bi._fromJSON(e,l);u!==s&&(a=h),s=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(u=>d(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new t(s,e,r))})}};function md(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(a_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(i_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(u_(e))return"Blackberry";if(l_(e))return"Webos";if(s_(e))return"Safari";if((e.includes("chrome/")||o_(e))&&!e.includes("edge/"))return"Chrome";if(c_(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function i_(t=he()){return/firefox\//i.test(t)}function s_(t=he()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function o_(t=he()){return/crios\//i.test(t)}function a_(t=he()){return/iemobile/i.test(t)}function c_(t=he()){return/android/i.test(t)}function u_(t=he()){return/blackberry/i.test(t)}function l_(t=he()){return/webos/i.test(t)}function Rd(t,e=[]){let n;switch(t){case"Browser":n=md(he());break;case"Worker":n=`${md(he())}-${t}`;break;default:n=t}let r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${wt}/${r}`}var Ic=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return d(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let r of this.queue)yield r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(let i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function h_(n){return d(this,arguments,function*(t,e={}){return zi(t,"GET","/v2/passwordPolicy",wd(t,e))})}var d_=6,vc=class{constructor(e){var n,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:d_,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Ec=class{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $i(this),this.idTokenSubscription=new $i(this),this.beforeStateQueue=new Ic(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=_t(n)),this._initializationPromise=this.queue(()=>d(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield qi.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return d(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUser(e){return d(this,null,function*(){var n;let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return d(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return d(this,null,function*(){try{yield Fi(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=jg()}_delete(){return d(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return d(this,null,function*(){let n=e?de(e):null;return n&&O(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return d(this,null,function*(){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>d(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return d(this,null,function*(){return yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0)})}setPersistence(e){return this.queue(()=>d(this,null,function*(){yield this.assertedPersistence.setPersistence(_t(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return d(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return d(this,null,function*(){let e=yield h_(this),n=new vc(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Oe("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},n)}})}revokeAccessToken(e){return d(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),yield n_(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return d(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return d(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&_t(e)||this._popupRedirectResolver;O(n,this,"argument-error"),this.redirectPersistenceManager=yield qi.create(this,[_t(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return d(this,null,function*(){var n,r;return this._isInitialized&&(yield this.queue(()=>d(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return d(this,null,function*(){if(e===this.currentUser)return this.queue(()=>d(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(n);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return d(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Rd(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return d(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(n["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n})}_getAppCheckToken(){return d(this,null,function*(){var e;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&qg(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function f_(t){return de(t)}var $i=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Hc(n=>this.observer=n)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};function p_(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function m_(t,e){let n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(_t);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}var BI=p_("rcb"),qI=new yt(3e4,6e4);var $I=new yt(2e3,1e4);var zI=10*60*1e3;var GI=new yt(3e4,6e4);var jI=new yt(5e3,15e3);var WI=encodeURIComponent("fac");var gd="@firebase/auth",_d="1.5.1";var wc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return d(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function g_(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function __(t){$e(new fe("auth",(e,{options:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;O(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Rd(t)},u=new Ec(r,i,s,c);return m_(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),$e(new fe("auth-internal",e=>{let n=f_(e.getProvider("auth").getImmediate());return(r=>new wc(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),K(gd,_d,g_(t)),K(gd,_d,"esm2017")}var y_=5*60,KI=$c("authIdTokenMaxAge")||y_;__("Browser");var _y="auth";var Gi=class{constructor(){return un(_y)}};var or=class{constructor(e){return e}},bd="firestore",Rc=class{constructor(){return un(bd)}};var bc=new ur("angularfire2.firestore-instances");function yy(t,e){let n=vs(bd,t,e);return n&&new or(n)}function Iy(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new or(r)}}var vy={provide:Rc,deps:[[new Ue,bc]]},Ey={provide:or,useFactory:yy,deps:[[new Ue,bc],tt]},wy=(()=>{class t{constructor(){K("angularfire",At.full,"fst")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=hr({type:t});static \u0275inj=cr({providers:[Ey,vy]})}return t})();function YE(t,...e){return{ngModule:wy,providers:[{provide:bc,useFactory:Iy(t),multi:!0,deps:[vt,dr,ln,dn,[new Ue,Gi],[new Ue,cn],...e]}]}}var JE=hn(ed,!0);export{qc as a,zc as b,le as c,de as d,fe as e,$e as f,_s as g,wt as h,an as i,K as j,At as k,vs as l,un as m,cn as n,ln as o,hn as p,tt as q,dn as r,oI as s,aI as t,Gi as u,Rg as v,bg as w,Vg as x,Fg as y,Ug as z,Bg as A,or as B,YE as C,JE as D};
